/*!CK:1531600164!*//*1450525030,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["6isKa"]); }

__d('ReactFeedComposerXBootloader',['ReactComposerAttachmentType','ReactComposerInit','ReactFeedComposerX.react','MinutiaeBootloadStore','Arbiter','AsyncRequest','ComposerEntryPointRef','CSS','DOM','Event','ReactInputSelection','SubscriptionsHandler','XReactComposerLoggingODSController','$','csx','getActiveElement'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){'use strict';if(c.__markCompiled)c.__markCompiled();var x,y={bootload:function(z,aa){var ba=u('pagelet_composer'),ca=p.find(ba,"._559p"),da=o.hasClass(ca,'async_saving');if(da){x=new s();x.addSubscriptions(q.listen(ca,'success',(function(){this._bootloadImpl(z,ba,aa);}).bind(this)),q.listen(ca,'error',(function(){this._bootloadImpl(z,ba,aa);}).bind(this)));}else this._bootloadImpl(z,ba,aa);},_bootloadImpl:function(z,aa,ba){ba.config.audienceXHP=this._getXHPToReactNode(aa,"._ej0");ba.prefillConfig=Object.assign(ba.prefillConfig,this._appendPrefillConfig(aa));i.init(j,ba,aa);var ca=t.getURIBuilder().setString('event','bootload_done').setEnum('composer_type',n.FEEDX).getURI();new m(ca).send();x&&x.release();l.inform('ReactFeedComposerXBootloader/bootload/'+z);},_appendPrefillConfig:function(z){var aa=p.find(z,"._3en1"),ba=w()==aa||o.hasClass(p.find(z,'.focus_target'),'child_was_focused'),ca=p.scry(z,"._21h8")[0];if(!ca)ca=p.find(z,"._5qtn");ca=ca.getAttribute('data-attachment-type');if(ca===h.NOTES)ca=null;var da=p.scry(z,"._21h7")[0];if(!da)da=p.find(z,"._4d6h");var ea=p.scry(da,'input[name="composer_photo[]"]')[0],fa={text:aa.value},ga=this._getXHPToReactNode(z,"._1sek"),ha=k.getMinutiaeData();return {mentionsInput:{textWithEntities:fa,selection:r.getSelection(aa)},instantMediaSelector:{fileInputDOM:ea},selectedAttachment:ca,shouldActivateSelectedAttachment:ba||!!ha,prompt:ga,taggersData:ha};},_getXHPToReactNode:function(z,aa){var ba=p.scry(z,aa);if(ba.length===0)return null;var ca=ba[0],da=ca.cloneNode(true);ca.parentNode.replaceChild(da,ca);return ca;}};f.exports=y;},null);