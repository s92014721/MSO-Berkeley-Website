/*!CK:1811373081!*//*1449710652,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["+u4og"]); }

__d('MessagesJewelThreadList.react',['BootloadedComponent.react','ImmutableObject','JSResource','Link.react','MessagesJewelThreadlistRowContainer.react','MessagingTag','React','ScrollableArea.react','XUISpinner.react','cx','debounce','fbt','getViewportDimensions','throttle'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){'use strict';if(c.__markCompiled)c.__markCompiled();var v=160,w=450,x=n.PropTypes,y=n.createClass({displayName:'MessagesJewelThreadList',propTypes:{isLoaded:x.bool,isLoading:x.bool,jewelRequestsUI:x.bool,onLoadMoreRequest:x.func,p2pJewelBannerContainer:x.element,threads:x.arrayOf(x.instanceOf(i)).isRequired,viewer:x.string.isRequired},getInitialState:function(){return {height:this._calculateHeight()};},componentDidMount:function(){this._listener=Event.listen(window,'resize',r((function(){this.setState({height:this._calculateHeight()});}).bind(this)));},componentWillUnmount:function(){this._listener.remove();},render:function(){return (n.createElement(o,{className:"_2q3u",height:this.state.height,onScroll:u(this._handleScroll,50),ref:'scrollable'},n.createElement('ul',{className:'jewelContent'},this.props.p2pJewelBannerContainer?n.createElement('li',null,this.props.p2pJewelBannerContainer):null,this._renderJewelRequestsUI(),this._renderJewelRequestsNUX(),this.props.threads.map((function(z){return (n.createElement(l,{key:z.thread_id,thread:z,viewer:this.props.viewer}));}).bind(this))),this._renderLoadMoreLink()));},_calculateHeight:function(){return Math.min(w,t().height-v);},_renderLoadMoreLink:function(){if(this.props.isLoaded){if(this.props.folder===m.PENDING)return (n.createElement('div',{className:"_16bh _16bi"},n.createElement(k,{onClick:this._handleFilteredRequestsClick},s._("See filtered requests"))));return null;}if(this.props.isLoading)return (n.createElement('div',{className:"_v8y"},n.createElement(p,null)));return (n.createElement('div',{className:"_v8y"},n.createElement(k,{href:'#',onClick:this._handleLoadMoreClick},s._("Show Older"))));},_handleScroll:function(){if(this.props.isLoaded)return;var z=this.refs.scrollable.getArea();if(z.getScrollTop()+z.getClientHeight()>=z.getScrollHeight()-1)this.props.onLoadMoreRequest&&this.props.onLoadMoreRequest();},_handleLoadMoreClick:function(z){z.preventDefault();this.props.onLoadMoreRequest&&this.props.onLoadMoreRequest();},_renderJewelRequestsUI:function(){var z=this.props.newMessageRequestThreads;if(!this.props.jewelRequestsUI||this.props.folder===m.PENDING||!z||z.length===0)return null;return (n.createElement(h,{bootloadPlaceholder:n.createElement('li',{style:{height:60}}),bootloadLoader:j('MessagesJewelMessageRequestsRow.react'),onClick:this._handleMessageRequestsClick,threads:z,viewer:this.props.viewer}));},_renderJewelRequestsNUX:function(){if(!this.props.jewelRequestsUI||this.props.folder!==m.PENDING)return null;return (n.createElement('li',{className:"_16bh _16bi"},s._("Open a request to get more info about who's messaging you."),n.createElement('br',null),s._("They won't know you've seen it until you accept.")));},_handleMessageRequestsClick:function(z){if(this.props.onMessageRequestsClick)this.props.onMessageRequestsClick(z);},_handleFilteredRequestsClick:function(z){if(this.props.onFilteredRequestsClick)this.props.onFilteredRequestsClick(z);}});f.exports=y;},null);