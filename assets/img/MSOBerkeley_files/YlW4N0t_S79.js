/*!CK:4199139930!*//*1450392651,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["H6mP1"]); }

__d('relativeTimeString.atlas',['fbt'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();function i(j,k){var l=Date.now(),m='',n=null,o=Math.floor((j-l)/1000),p=o<0;o=Math.abs(o);if(o<60){if(k){m=p?h._("just now"):h._("now");}else m=p?h._("Just now"):h._("Now");}else if(o<60*2){m=p?h._("1 minute ago"):h._("1 minute");}else if(o<3600){n=Math.floor(o/60);m=p?h._("{number} minutes ago",[h.param('number',n)]):h._("{number} minutes",[h.param('number',n)]);}else if(o<3600*2){if(k){m=p?h._("about an hour ago"):h._("about an hour");}else m=p?h._("About an hour ago"):h._("About an hour");}else if(o<3600*24){n=Math.floor(o/3600);m=p?h._("{number} hours ago",[h.param('number',n)]):h._("{number} hours",[h.param('number',n)]);}else if(o<3600*24*2){if(k){m=p?h._("about a day ago"):h._("about a day");}else m=p?h._("About a day ago"):h._("About a day");}else if(o<3600*24*30){n=Math.floor(o/3600/24);m=p?h._("{number} days ago",[h.param('number',n)]):h._("{number} days",[h.param('number',n)]);}else if(o<3600*24*30*2){if(k){m=p?h._("about a month ago"):h._("about a month");}else m=p?h._("About a month ago"):h._("About a month");}else if(o<3600*24*30*12){n=Math.floor(o/3600/24/30);m=p?h._("{number} months ago",[h.param('number',n)]):h._("{number} months",[h.param('number',n)]);}else if(o<3600*24*30*24){if(k){m=p?h._("over a year ago"):h._("over a year");}else m=p?h._("Over a year ago"):h._("Over a year");}else{n=Math.floor(o/3600/24/365);m=p?h._("{number} years ago",[h.param('number',n)]):h._("{number} years",[h.param('number',n)]);}return m;}f.exports=i;},null);
__d('MessengerSignals',['EventEmitter'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i=new h(),j='resize',k={resize:function(){i.emit(j);},onResize:function(l){return i.addListener(j,l);}};f.exports=k;},null);
__d('MessengerAttachmentImageBlock.react',['React','cx','joinClasses'],function a(b,c,d,e,f,g,h,i,j){'use strict';if(c.__markCompiled)c.__markCompiled();var k=h.PropTypes,l=h.createClass({displayName:'MessengerAttachmentImageBlock',propTypes:{attachment:k.object.isRequired},render:function(){return (h.createElement('div',{className:j(this.props.className,this._computeClass())},this._renderImage(),h.createElement('div',{className:"_5swm"},this.props.children)));},_renderImage:function(){if(!this.props.attachment.media||!this.props.attachment.media.image)return null;var n=this._getDimensions(),o=n.height,p=n.width,q=o>p,r=m(o,p),s=o&&p?o/p*100:100,t=q||r?.2:1,u=q||r?s:52,v={backgroundImage:'url('+this.props.attachment.media.image+')',minHeight:'0px',paddingBottom:q&&s>150?'136px':u*t+'%'};if(this.props.attachment.description&&this.props.attachment.source)v.minHeight='112px';return (h.createElement('div',{className:"_3xn1",style:v}));},_computeClass:function(){if(!this.props.attachment.media||!this.props.attachment.media.image)return "_3xn3 _5swn";var n=this._getDimensions(),o=n.height,p=n.width,q=o>p;return "_3xn3"+(m(o,p)&&!q?' '+"_3xn5":'')+(q?' '+"_3xn6":'')+(p>=o?' '+"_3xn7":'');},_getDimensions:function(){var n=this.props.attachment.properties||{},o=n.height,p=n.width;if(o&&p){o=parseInt(o,10);p=parseInt(p,10);return {height:o,width:p};}return {height:0,width:0};}});function m(n,o){return n<=300&&o<=300;}f.exports=l;},null);
__d('MessengerFlexArea.react',['Event','MessengerSignals','React','ReactDOM','ResponsiveBlock.react','Style','SubscriptionsHandler','Vector','getScrollPosition','throttle'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){'use strict';if(c.__markCompiled)c.__markCompiled();var r=j.PropTypes,s=j.createClass({displayName:'MessengerFlexArea',propTypes:{beforeResize:r.func,onResize:r.func},_subscriptions:null,_onResizeTimeout:null,getInitialState:function(){return {height:0};},componentDidMount:function(){var t=new n();t.addSubscriptions(h.listen(window,'resize',q(this.recalculateHeight,51)),i.onResize((function(){this.recalculateHeight();}).bind(this)));this._subscriptions=t;this.recalculateHeight();},componentWillUnmount:function(){this._subscriptions&&this._subscriptions.release();clearTimeout(this._onResizeTimeout);},render:function(){return (j.createElement(l,{className:this.props.className,onResize:this._handleResponsiveBlockResize,style:{height:this.state.height+'px'}},this.props.children));},recalculateHeight:function(){if(!this.isMounted())return;var t=k.findDOMNode(this),u=t.parentNode,v=this.state.height,w=o.getViewportDimensions().y,x=false;if(u&&m.get(u,'display')==='none'){m.set(u,'display','initial');x=true;}w-=o.getElementPosition(u||t).y;var y=p(window);w+=y.y;if(u){Array.from(u.childNodes).forEach(function(z){if(z.nodeType===Node.COMMENT_NODE||m.get(z,'position')==='absolute')return;w-=o.getElementDimensions(z).y;});w+=o.getElementDimensions(t).y;}if(x)m.set(u,'display','');if(isNaN(w)||w<0)w=0;if(w!==v){this.props.beforeResize&&this.props.beforeResize();this.setState({height:w},this.props.onResize);}},_handleResponsiveBlockResize:q(function(t,u){if(!this.isMounted())return;if(u===this.state.height){this.props.beforeResize&&this.props.beforeResize();clearTimeout(this._onResizeTimeout);if(this.props.onResize)this._onResizeTimeout=setTimeout(this.props.onResize,0);}},51)});f.exports=s;},null);
__d('MessengerScrollableArea.react',['React','ReactDOM','ScrollableArea.react','Style','UserAgent','clearImmediate','cx','joinClasses','setImmediate','throttle'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){'use strict';if(c.__markCompiled)c.__markCompiled();var r=h.PropTypes,s=20,t=h.createClass({displayName:'MessengerScrollableArea',propTypes:{onScroll:r.func,width:r.number},_resizeCallback:null,componentDidMount:function(){this._resizeCallback=p(this._resize);},componentWillUnmount:function(){m(this._resizeCallback);},render:function(){return (h.createElement(j,{className:o("_5f0v",this.props.className),onScroll:this._handleScroll,ref:'scrollable',shadow:false,style:this.props.style,tabIndex:this.props.tabIndex,width:this.props.width},this.props.children));},_handleScroll:q(function(){var u;this.props.onScroll&&(u=this.props).onScroll.apply(u,arguments);},50),_resize:function(){if(!l.isBrowser('IE'))return;var u=this.refs.scrollable.refs.wrap,v=this.refs.scrollable.refs.body;if(!v||!u)return;v=i.findDOMNode(v);u=i.findDOMNode(u);var w=u.offsetWidth-u.clientWidth;if(w>0)k.set(v,'margin-right',-w+'px');},getArea:function(){return this.refs.scrollable.getArea();},scrollToBottom:function(){var u=this.getArea();if(u)this.scrollToPosition(u.getScrollHeight());},scrollToTop:function(u){var v=this.getArea();if(v)v.scrollToTop(!!u);},scrollToPosition:function(u){var v=this.getArea();if(!v)return;v.setScrollTop(u,false);},isScrolledToBottom:function(){var u=this.getArea();if(!u)return false;return u.getScrollTop()+u.getClientHeight()>=u.getScrollHeight()-s;},isScrolledToTop:function(){var u=this.getArea();if(!u)return true;return u.getScrollTop()<=s;},getScrollTop:function(){var u=this.getArea();if(!u)return 0;return u.getScrollTop();}});f.exports=t;},null);
__d('MessengerFlexScrollableArea.react',['MessengerFlexArea.react','MessengerScrollableArea.react','React'],function a(b,c,d,e,f,g,h,i,j){'use strict';if(c.__markCompiled)c.__markCompiled();var k=j.PropTypes,l=j.createClass({displayName:'MessengerFlexScrollableArea',propTypes:{flexChildren:k.node,onScroll:k.func,shouldStickToBottom:k.bool},render:function(){return (j.createElement(h,{beforeResize:this._prepareForResize,className:this.props.className,onResize:this._handleResize,ref:'flexArea'},this.props.flexChildren,j.createElement(i,{height:'100%',onScroll:this.props.onScroll,ref:'scrollable',tabIndex:this.props.tabIndex},this.props.children)));},getArea:function(){return this.refs.scrollable.getArea();},_prepareForResize:function(){this._wasScrolledToBottom=this.refs.scrollable.isScrolledToBottom();},_handleResize:function(){if(this._wasScrolledToBottom&&this.props.shouldStickToBottom)this.refs.scrollable.scrollToBottom();},handleResize:function(){this.refs.flexArea&&this.refs.flexArea.recalculateHeight();},scrollToBottom:function(){this.refs.scrollable.scrollToBottom();},scrollToTop:function(m){this.refs.scrollable.scrollToTop(m);},scrollToPosition:function(m){this.refs.scrollable.scrollToPosition(m);},isScrolledToBottom:function(){return this.refs.scrollable.isScrolledToBottom();},isScrolledToTop:function(){return this.refs.scrollable.isScrolledToTop();},getScrollTop:function(){return this.refs.scrollable.getScrollTop();}});f.exports=l;},null);
__d('MNCommerceBubbleImage.react',['React','cx','joinClasses'],function a(b,c,d,e,f,g,h,i,j){'use strict';if(c.__markCompiled)c.__markCompiled();var k=h.PropTypes,l=h.createClass({displayName:'MNCommerceBubbleImage',propTypes:{location:k.string,source:k.string.isRequired,width:k.number},render:function(){return (h.createElement('div',{className:j("_4y9n",this.props.className),style:{backgroundImage:'url(\''+this.props.source+'\')'}}));}});f.exports=l;},null);
__d('MNCommerceAgentItemSuggestionMercuryAttachment.react',['Image.react','LeftRight.react','Link.react','LineClamp.react','MercuryShareAttachmentRenderLocations','MNCommerceAgenItemSuggestionReactShape','MNCommerceBubbleImage.react','React','ReactComponentWithPureRenderMixin','ix','cx','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){'use strict';if(c.__markCompiled)c.__markCompiled();var t=o.PropTypes,u=3,v=o.createClass({displayName:'MNCommerceAgentItemSuggestionMercuryAttachment',mixins:[p],propTypes:{isPurchased:t.bool,itemSuggestion:m.isRequired,location:t.oneOf(l.getValues()),onBuyClick:t.func,width:t.number},render:function(){var w=this.props.itemSuggestion,x=w.thumb_url?o.createElement('div',{className:"_522n"},o.createElement(n,{location:this.props.location,source:w.thumb_url,width:this.props.width})):null,y=null;if(w.desc)y=o.createElement(k,{lines:u},w.desc);var z={};if(this.props.location===l.CHAT&&this.props.width)z.width=this.props.width;var aa=o.createElement('div',{className:(!w.target_url?"_522-":'')+(this.props.location===l.WEB_INBOX?' '+"_1hf9":''),style:z},x,o.createElement('div',{className:"_522o"},o.createElement('div',{className:"_522p"},w.name),y,o.createElement('div',{className:"_522q"},w.merchant_name)),this._renderFooter());if(w.target_url)return (o.createElement(j,{className:"_522-",href:w.target_url,target:'_blank',shimhash:w.shimhash},aa));return aa;},_renderFooter:function(){var w=this.props.itemSuggestion.total_cost;if(!w||w.amount<=0)return null;var x;if(!this.props.isPurchased){x=o.createElement('div',{className:"_522s",onClick:this._onBuyClick},s._("Get"));}else x=o.createElement('div',{className:"_1x98"},o.createElement(h,{className:"_1x99",src:q('/images/messaging/commerce/paid_check.png')}),s._("Paid"));return (o.createElement(i,{className:"_522r"},s._("Total: {total cost}",[s.param('total cost',this.props.itemSuggestion.display_total_cost)]),x));},_onBuyClick:function(w){w.preventDefault();this.props.onBuyClick&&this.props.onBuyClick();}});f.exports=v;},null);
__d('MercuryShareImage.react',['ChatImageArrowDirection','ChatImageWithArrow.react','React','cx'],function a(b,c,d,e,f,g,h,i,j,k){'use strict';if(c.__markCompiled)c.__markCompiled();var l=j.PropTypes,m=j.createClass({displayName:'MercuryShareImage',propTypes:{height:l.number.isRequired,round:l.bool,source:l.string.isRequired,width:l.number.isRequired},render:function(){return (j.createElement('div',{className:"_4hsl"},j.createElement(i,{arrowDirection:h.BOTH,height:this.props.height,round:!!this.props.round,source:this.props.source,width:this.props.width})));}});f.exports=m;},null);
__d('MercuryFallbackShareAttachmentContent.react',['Image.react','ImageBlock.react','MercuryFallbackShareAttachmentTextBlock.react','MercuryShareAttachmentRenderLocations','MercuryShareAttachmentReactShape','MercuryShareImage.react','MessengerAttachmentImageBlock.react','React','URI','cx','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){'use strict';if(c.__markCompiled)c.__markCompiled();var s=o.PropTypes,t=72,u=o.createClass({displayName:'MercuryFallbackShareAttachmentContent',propTypes:{attachment:l,location:s.oneOf(k.getValues())},render:function(){var v=this.props.attachment,w=this.props.location,x=(k.CHAT===w?"_49or":'')+(k.WEB_INBOX===w?' '+"__nm":'')+(k.CHAT_PREVIEW===w?' '+"_324d":'')+(k.CHAT!==w?' '+"_tih":'')+(!(v&&v.media.image)?' '+"_49ou":'');if(v.media&&v.media.image){if(k.CHAT===w||k.CHAT_PREVIEW===w){return (o.createElement(i,{className:x,spacing:'medium'},o.createElement(m,{height:t,source:v.media.image,width:t}),o.createElement('div',{style:{display:'flex',justifyContent:'center',flexDirection:'column',height:t}},o.createElement(j,this.props))));}else if(k.MESSENGER===w)return (o.createElement(n,{className:x,attachment:v},o.createElement(j,this.props),this.props.children));return (o.createElement(i,{className:r(this.props.className,x)},o.createElement(h,{className:"__6n",src:v.media.image,width:t}),o.createElement(j,this.props),this.props.children));}return (o.createElement('div',{className:r(this.props.className,x)},o.createElement(j,this.props),this.props.children));}});f.exports=u;},null);
__d('MercuryFallbackShareAttachment.react',['Link.react','MercuryFallbackShareAttachmentContent.react','MercuryShareAttachmentRenderLocations','MercuryShareAttachmentReactShape','React','cx'],function a(b,c,d,e,f,g,h,i,j,k,l,m){'use strict';if(c.__markCompiled)c.__markCompiled();var n=l.PropTypes,o=l.createClass({displayName:'MercuryFallbackShareAttachment',propTypes:{attachment:k,location:n.oneOf(j.getValues())},renderLink:function(p){if(j.isPreview(this.props.location))return p;return (l.createElement(h,{className:"_5rw4",href:this.props.attachment.uri,target:'_blank'},p));},render:function(){return this.renderLink(l.createElement(i,this.props));}});f.exports=o;},null);
__d('P2PCreditCardForm.react',['CreditCardFormParam','FBPaymentsCreditCardForm.react','MessengerPaymentProductType','P2PAPIUtils','P2PAPI','React','getObjectValues'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n){'use strict';if(c.__markCompiled)c.__markCompiled();var o=m.PropTypes,p=m.createClass({displayName:'P2PCreditCardForm',propTypes:{asyncRequestState:o.object,onValidation:o.func.isRequired,productType:o.oneOf(n(j))},getDefaultProps:function(){return {asyncRequestState:{},productType:j.P2P};},getInitialState:function(){return {binError:'',previousBINNumber:'',validateBINRequestID:''};},componentWillReceiveProps:function(q){var r=q.asyncRequestState,s=r?r[this.state.validateBINRequestID]:null;if(s){this.setState({validateBINRequestID:''});if(s.error){this.handleValidateBINNumberError(s.error);}else this.handleValidateBINNumberSuccess();}},handleValidateBINNumberSuccess:function(){this.setState({binError:''});},handleValidateBINNumberError:function(q){var r=q.message;this.setState({binError:r});},validateBIN:function(q){var r,s;q=q.replace(/ /g,'');r=q.substr(0,6);if(r!==this.state.previousBINNumber&&r.length>=6){s=k.genRequestID();this.setState({validateBINRequestID:s});l.validateBINNumber({binNumber:r,requestID:s});}else if(r.length<6)this.setState({binError:'',validateBINRequestID:''});this.setState({previousBINNumber:r});},handleValidation:function(q,r){var s=r[h.CARD_NUMBER];if(!this.props.editMode&&this.props.productType===j.P2P&&s)this.validateBIN(s);this.props.onValidation(q,r);},render:function(){return (m.createElement(i,babelHelpers._extends({},this.props,{allowCredit:this.props.productType===j.MESSENGER_COMMERCE,binError:this.state.binError,onValidation:this.handleValidation})));}});f.exports=p;},null);
__d('P2PAddCreditCardDialog.react',['CurrentEnvironment','Link.react','MessengerPaymentProductType','P2PAPI','P2PAPIUtils','P2PCreditCardStore','P2PCreditCardForm.react','P2PLoadingMask.react','P2PLogger','P2PPaymentLoggerEvent','P2PLinkConstants','React','P2PButton.react','P2PDialog.react','P2PDialogTitle.react','P2PDialogBody.react','P2PDialogFooter.react','P2PText.react','cx','emptyFunction','fbt','getObjectValues'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca){'use strict';if(c.__markCompiled)c.__markCompiled();var da=s.PropTypes,ea='fbP2PAddCreditCardDialog_learnMoreSentenceID',fa=s.createClass({displayName:'P2PAddCreditCardDialog',propTypes:{cancelButtonText:da.string,eventFlow:da.string.isRequired,loggingData:da.object,loggingObjectID:da.string,onCancel:da.func,onSuccess:da.func,productType:da.oneOf(ca(j)),saveButtonText:da.string,showCancelButton:da.bool,text:da.string,title:da.string},getDefaultProps:function(){var ga;if(h.messengerdotcom){ga=480;}else ga=430;return {cancelButtonText:ba._("Cancel"),loggingData:{},onCancel:aa,onSuccess:aa,productType:j.P2P,saveButtonText:ba._("Save"),showCancelButton:true,text:ba._("Please enter a debit card. Credit cards can't be used."),title:ba._("Add Debit Card"),width:ga};},getInitialState:function(){return {isValid:false,formData:{},loading:false,requestID:'',saveErrors:null};},onCreditCardStoreChange:function(){var ga=m.getAsyncRequestState(),ha=ga[this.state.requestID];this.setState({asyncRequestState:ga});if(ha){this.setState({requestID:''});if(ha.error){this.handleOnSaveError(ha.error);}else this.handleOnSaveSuccess(ha);}},componentDidMount:function(){this.log(q.UI_ACTN_INITIATE_ADD_CARD);this.creditCardStoreSub=m.addListener('change',this.onCreditCardStoreChange);},componentWillUnmount:function(){if(this.creditCardStoreSub){this.creditCardStoreSub.remove();this.creditCardStoreSub=null;}},log:function(ga,ha){p.log(ga,babelHelpers._extends({www_event_flow:this.props.eventFlow,object_id:this.props.loggingObjectID},this.props.loggingData,ha));},onSaveClick:function(){var ga=l.genRequestID();this.setState({loading:true,requestID:ga,saveErrors:null});this.log(q.UI_ACTN_CONFIRM_CARD_DETAILS);k.addCreditCard(babelHelpers._extends({requestID:ga,product_type:this.props.productType},this.state.formData));},handleOnSaveSuccess:function(ga){this.props.onSuccess(ga);this.log(q.UI_ACTN_ADD_CARD_SUCCESS);},handleOnSaveError:function(ga){this.setState({loading:false,saveErrors:ga});this.log(q.UI_ACTN_ADD_CARD_FAIL,{message:ga&&ga.general?ga.general.message:''});},handleValidation:function(ga,ha){this.setState({isValid:ga,formData:ha});},isSaveButtonDisabled:function(){return this.state.loading||!this.state.isValid;},onToggle:function(ga){if(!ga){this.props.onCancel();this.log(q.UI_ACTN_CANCEL_ADD_CARD);}},onCancelClicked:function(){this.onToggle(false);},renderAddCardForm:function(){var ga,ha=this.props.title;if(this.props.showCancelButton)ga=s.createElement(t,{use:'default',size:'medium',label:this.props.cancelButtonText,disabled:this.state.loading,onClick:this.onCancelClicked});return (s.createElement('div',null,s.createElement(v,null,ha),s.createElement(w,null,s.createElement(y,{type:'primary',className:"_3-96"},this.props.text),s.createElement(n,{asyncRequestState:this.state.asyncRequestState,compactMode:true,onValidation:this.handleValidation,productType:this.props.productType,saveErrors:this.state.saveErrors,showIcons:false,showLabels:true,showPlaceholderOnFocus:true,showSecondaryIcons:true,useGutters:true}),s.createElement(y,{className:"_3-8y",id:ea,type:'secondary'},ba._("Your payment info is stored securely."),s.createElement('div',null,s.createElement(i,{'aria-describedby':ea,href:r.addDebitCardHelpURI,target:'_blank'},ba._("Learn More"))))),s.createElement(x,{leftContent:this.props.leftContent},ga,s.createElement(t,{use:'confirm',size:'medium',label:this.props.saveButtonText,disabled:this.isSaveButtonDisabled(),onClick:this.onSaveClick}))));},render:function(){return (s.createElement(u,{behaviors:this.props.behaviors,layerHideOnBlur:false,ref:'dialog',onToggle:this.onToggle,repositionOnUpdate:true,shown:true,width:this.props.width},this.renderAddCardForm(),s.createElement(o,{visible:this.state.loading})));}});f.exports=fa;},null);
__d('P2PChooseCreditCardDialog.react',['CurrentEnvironment','P2PButton.react','P2PChooseCreditCardForm.react','P2PCreditCard','P2PDialog.react','P2PDialogBody.react','P2PDialogFooter.react','P2PDialogTitle.react','P2PLoadingMask.react','P2PText.react','React','cx','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){'use strict';if(c.__markCompiled)c.__markCompiled();var u=h.messengerdotcom,v=r.PropTypes,w=r.createClass({displayName:'P2PChooseCreditCardDialog',propTypes:{addCardOptionText:v.string,cancelButtonText:v.string,creditCards:v.arrayOf(v.instanceOf(k)).isRequired,onAddDebitCardOptionSelected:v.func.isRequired,onClose:v.func.isRequired,onSelected:v.func.isRequired,saveButtonText:v.string.isRequired,selectedCreditCard:v.instanceOf(k).isRequired,showCancelButton:v.bool,showLoading:v.bool,text:v.string,title:v.string,width:v.number},getDefaultProps:function(){return {cancelButtonText:t._("Cancel"),showCancelButton:false,text:t._("You can use a debit card you've already added to Facebook or add a new one."),title:t._("Select Debit Card")};},getInitialState:function(){return {loading:false,selectedCreditCard:this.props.selectedCreditCard};},handleAddDebitCardOptionClicked:function(){this.props.onAddDebitCardOptionSelected();},handleCreditCardSelected:function(x){this.setState({selectedCreditCard:x});},handleSelected:function(){this.setState({loading:true});this.props.onSelected(this.state.selectedCreditCard);},handleToggle:function(x){if(!x)this.props.onClose();},render:function(){var x;if(this.props.showCancelButton)x=r.createElement(i,{disabled:this.props.showLoading,label:this.props.cancelButtonText,onClick:this.props.onClose,size:'medium',use:'default'});return (r.createElement(l,{behaviors:this.props.behaviors,className:u?"_auz":'',onToggle:this.handleToggle,width:this.props.width},r.createElement(o,null,this.props.title),r.createElement(m,{className:"_383d"},r.createElement(q,{type:'primary',className:"_au_"},this.props.text),r.createElement(j,{addCardOptionText:this.props.addCardOptionText,className:"_2pi4",creditCards:this.props.creditCards,onAddDebitCardOptionSelected:this.handleAddDebitCardOptionClicked,onChange:this.handleCreditCardSelected,selectedCard:this.props.selectedCreditCard,showAddDebitCardOption:true})),r.createElement(n,null,x,r.createElement(i,{disabled:this.props.showLoading,label:this.props.saveButtonText,onClick:this.handleSelected,size:'medium',use:'confirm'})),r.createElement(p,{visible:this.props.showLoading})));}});f.exports=w;},null);
__d('P2PEditCreditCardDialog.react',['CreditCardFormParam','CurrentEnvironment','Link.react','React','P2PAPI','P2PAPIUtils','P2PCreditCard','P2PCreditCardForm.react','P2PLoadingMask.react','P2PLinkConstants','P2PDialog.react','P2PDialogTitle.react','P2PDialogBody.react','P2PDialogFooter.react','P2PButton.react','P2PText.react','cx','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y){'use strict';if(c.__markCompiled)c.__markCompiled();var z='fbP2PEditCreditCardDialog_learnMoreSentenceID',aa=k.PropTypes,ba=k.createClass({displayName:'P2PEditCreditCardDialog',propTypes:{asyncRequestState:aa.object.isRequired,creditCard:aa.instanceOf(n).isRequired,onCancel:aa.func.isRequired,onSuccess:aa.func.isRequired,saveButtonText:aa.string,showCancelButton:aa.bool},getInitialState:function(){return {formData:{},isValid:false,loading:false,requestID:'',saveErrors:null};},getDefaultProps:function(){return {saveButtonText:y._("Save"),showCancelButton:true,width:i.messengerdotcom?350:300};},componentWillReceiveProps:function(ca){var da=ca.asyncRequestState?ca.asyncRequestState[this.state.requestID]:null;if(da){this.setState({requestID:''});if(da.error){this.handleOnSaveError(da.error);}else this.handleOnSaveSuccess(da);}},clearSaveErrors:function(){this.setState({saveErrors:null});},onSaveClick:function(ca){var da={},ea=m.genRequestID();da[h.CREDENTIAL_ID]=this.props.creditCard.getCredentialId();this.clearSaveErrors();this.setState({loading:true,requestID:ea});l.updateCreditCard(babelHelpers._extends({requestID:ea},da,this.state.formData));},handleOnSaveSuccess:function(ca){this.props.onSuccess(ca);},onCancelClick:function(ca){this.props.onCancel();},handleOnSaveError:function(ca){this.setState({loading:false,saveErrors:ca});},isSaveDisabled:function(){return !this.state.isValid||this.state.loading;},isCancelDisabled:function(){return this.state.loading;},handleValidation:function(ca,da){this.setState({isValid:ca,formData:da});},getPrefilledFormData:function(){var ca={};ca[h.CARD_NUMBER]=this.props.creditCard.getCreditCardNumberMask();ca[h.CARD_EXPIRATION]=this.props.creditCard.getExpFormattedShort();ca[h.ZIP]=this.props.creditCard.getZipCode();return ca;},handleErrorDialogOKClick:function(){this.clearSaveErrors();},onToggle:function(ca){if(!ca)this.props.onCancel();},render:function(){var ca,da=this.props.text;if(!da)da=y._("Please update the expiration date for your card ending in {card numbers}.",[y.param('card numbers',this.props.creditCard.getCreditCardNumber())]);if(this.props.showCancelButton)ca=k.createElement(v,{use:'default',size:'medium',label:y._("Cancel"),disabled:this.isCancelDisabled(),onClick:this.onCancelClick});return (k.createElement(r,{behaviors:this.props.behaviors,layerHideOnBlur:false,onToggle:this.onToggle,repositionOnUpdate:true,shown:true,width:this.props.width},k.createElement(s,null,y._("Update Debit Card")),k.createElement(t,null,k.createElement(w,{className:"_3-96",type:'primary'},da),k.createElement(o,{onValidation:this.handleValidation,saveErrors:this.state.saveErrors,editMode:true,prefilledFormData:this.getPrefilledFormData(),cscMaxLength:this.props.creditCard.getMaxCSCLength()}),k.createElement(w,{className:"_3-8y",id:z,type:'secondary'},y._("Your payment info is stored securely. {Learn more about p2p link}",[y.param('Learn more about p2p link',k.createElement(j,{'aria-describedby':z,href:q.addDebitCardHelpURI,target:'_blank'},y._("Learn more.")))]))),k.createElement(u,null,ca,k.createElement(v,{use:'confirm',size:'medium',label:this.props.saveButtonText,disabled:this.isSaveDisabled(),onClick:this.onSaveClick})),k.createElement(p,{visible:this.state.loading})));}});f.exports=ba;},null);
__d('P2PBigAmount.react',['CurrentEnvironment','Image.react','React','cx','ix'],function a(b,c,d,e,f,g,h,i,j,k,l){'use strict';if(c.__markCompiled)c.__markCompiled();var m=j.PropTypes,n=j.createClass({displayName:'P2PBigAmount',propTypes:{amount:m.string.isRequired,isPending:m.bool,size:m.oneOf(['medium','large'])},getDefaultProps:function(){return {size:'medium'};},getImage:function(){if(this.isMessengerDotCom()){if(this.props.isPending){if(this.props.size==='large'){return l('/images/p2p/message-icon-dark-gray-large.png');}else return l('/images/p2p/message-icon-dark-gray.png');}else if(this.props.size==='large'){return l('/images/p2p/message-icon-messenger-blue.png');}else return l('/images/p2p/message-icon-blue.png');}else if(this.props.isPending){if(this.props.size==='large'){return l('/images/p2p/message-icon-gray-large.png');}else return l('/images/p2p/message-icon-gray.png');}else if(this.props.size==='large'){return l('/images/p2p/message-icon-facebook-blue.png');}else return l('/images/p2p/message-icon-www-blue.png');},isMessengerDotCom:function(){return h.messengerdotcom;},render:function(){var o=this.props.size==='large'?'24':'16';return (j.createElement('div',{className:"_8j6"+(this.isMessengerDotCom()?' '+"_8j7":'')+(this.props.size==='large'?' '+"_1fv":'')},j.createElement('div',{className:"_8j8"},j.createElement(i,{height:o,src:this.getImage(),width:o})),j.createElement('div',{className:"_8jc"+(this.props.isPending?' '+"_8jd":'')+(this.props.amount.length>=8?' '+"_8je":'')+(' '+"_3oh-")},this.props.amount)));}});f.exports=n;},null);
__d('P2PMoneypennyCheckoutDialog.react',['CurrentEnvironment','Link.react','MNCommerceAgenItemSuggestionReactShape','P2PBigAmount.react','P2PButton.react','P2PCreditCard','P2PDialog.react','P2PDialogBody.react','P2PDialogFooter.react','P2PDialogTitle.react','P2PLoadingMask.react','P2PMoneypennyProductItemDetails.react','P2PText.react','React','ReactComponentWithPureRenderMixin','cx','fbt','ix'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y){'use strict';if(c.__markCompiled)c.__markCompiled();var z=u.PropTypes,aa=u.createClass({displayName:'P2PMoneypennyCheckoutDialog',mixins:[v],propTypes:{cancelButtonText:z.string,item:j.isRequired,leftContentText:z.string,onClose:z.func.isRequired,onChangeCreditCard:z.func.isRequired,onNextClicked:z.func.isRequired,onPurchaseClicked:z.func.isRequired,selectedCreditCard:z.instanceOf(m),showCancelButton:z.bool,showLoading:z.bool},getDefaultProps:function(){return {cancelButtonText:x._("Cancel"),leftContentText:x._("You'll add a debit card next."),showCancelButton:false,width:360};},handleToggle:function(ba){if(!ba)this.props.onClose();},renderPaymentDetails:function(){var ba=this.props.selectedCreditCard;if(!ba)return null;return (u.createElement(t,{className:"_1t0k",shade:'light',size:'small',type:'secondary'},ba.getDetailsFormatted()+' \u00b7 ',u.createElement(i,{className:"_1t0l",onClick:this.props.onChangeCreditCard,href:'#'},x._("Change"))));},renderFooter:function(){var ba,ca,da;if(!this.props.selectedCreditCard){ba=u.createElement(t,{className:"_1t0n",type:'secondary'},this.props.leftContentText);ca=u.createElement(l,{label:x._("Next"),onClick:this.props.onNextClicked,size:'medium',type:'primary',use:'default'});}else ca=u.createElement(l,{label:x._("Pay"),onClick:this.props.onPurchaseClicked,size:'medium',type:'primary',use:'confirm'});if(this.props.showCancelButton)da=u.createElement(l,{use:'default',size:'medium',label:this.props.cancelButtonText,disabled:this.props.showLoading,onClick:this.props.onClose});return (u.createElement(p,{leftContent:ba},da,ca));},renderAmountSection:function(){return (u.createElement('div',{className:"_1t0o"},u.createElement('div',{className:"_4qbr"},u.createElement(k,{amount:this.props.item.raw_amount,size:'large'})),this.renderPaymentDetails(),u.createElement(t,{className:"_1wb1",shade:'light',size:'small',type:'secondary'},'We',"'",'ll place your order with the business when we receive your payment.')));},render:function(){var ba;if(!h.messengerdotcom)ba=u.createElement(q,null,x._("Payment"));return (u.createElement(n,{layerHideOnBlur:false,onToggle:this.handleToggle,shown:true,width:this.props.width},ba,u.createElement(o,null,u.createElement('div',{className:"_b0z"},u.createElement(s,{item:this.props.item})),this.renderAmountSection()),this.renderFooter(),u.createElement(r,{visible:this.props.showLoading})));}});f.exports=aa;},null);
__d('P2PMoneypennyStore',['P2PActionConstants','EventEmitter','ImmutableObject','P2PDispatcher'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l,m;'use strict';var n,o,p;function q(t,u){if(t)p[t]=new j(u);}function r(t,u){if(t)p[t]={error:u};}l=babelHelpers.inherits(s,i);m=l&&l.prototype;function s(){m.constructor.call(this);p={};o=[];n=k.register(this.onEventDispatched.bind(this));}s.prototype.onEventDispatched=function(t){var u=t.data,v=t.type;switch(v){case h.MONEYPENNY_TRANSFER_CREATED:this.handleMoneypennyTransferCreated(u);this.emit('change');break;case h.MONEYPENNY_TRANSFER_CREATED_ERROR:this.handleMoneypennyTransferCreatedError(u);this.emit('change');break;}};s.prototype.getAsyncRequestState=function(){return p;};s.prototype.handleMoneypennyTransferCreated=function(t){var u;q(t.requestID,t);u=o.filter(function(v){return (v.payment_id===t.payment_id);})[0];if(!u)o.push(new j(t));};s.prototype.handleMoneypennyTransferCreatedError=function(t){r(t.requestID,t.error);};s.prototype.getTransferByID=function(t){return o.filter(function(u){return u.item_id===t;})[0];};f.exports=new s();},null);
__d('P2PPasswordProtectionNUXDialog.react',['CurrentEnvironment','Link.react','P2PAPI','P2PErrorDialog.react','P2PLinkConstants','P2PLoadingMask.react','P2PLogger','P2PPaymentLoggerEvent','P2PPaymentLoggerEventFlow','P2PPasswordProtectionParam','P2PPasswordProtectionStatusTypes','React','P2PButton.react','P2PDialog.react','P2PDialogTitle.react','P2PDialogBody.react','P2PDialogFooter.react','P2PText.react','cx','emptyFunction','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba){'use strict';if(c.__markCompiled)c.__markCompiled();var ca=s.PropTypes,da=s.createClass({displayName:'P2PPasswordProtectionNUXDialog',propTypes:{onComplete:ca.func},getDefaultProps:function(){return {onComplete:aa,width:h.messengerdotcom?320:300};},getInitialState:function(){return {saveErrorObject:null,loading:false};},componentWillMount:function(){this.log(o.UI_ACTN_INITIATE_PASSWORD_PROTECTION_NUX);},log:function(ea,fa){n.log(ea,babelHelpers._extends({www_event_flow:p.UI_FLOW_P2P_SETTINGS},fa));},onSaveClick:function(){this.setState({loading:true,saveErrorObject:null});this.setPasswordProtection(r.ENABLED);this.log(o.UI_ACTN_OPT_IN_PASSWORD_PROTECTION_NUX);},setPasswordProtection:function(ea){var fa={};fa[q.STATUS]=ea;j.setPasswordProtectionSetting({formData:fa,success:this.handleOnSaveSuccess,error:this.handleOnSaveError});},handleOnSaveSuccess:function(){this.setState({loading:false});this.props.onComplete();},handleOnSaveError:function(ea){this.setState({loading:false,saveErrorObject:ea});},isSaveButtonDisabled:function(){return this.state.loading;},isCancelButtonDisabled:function(){return this.state.loading;},onCancelClick:function(){this.setState({loading:true,saveErrorObject:null});this.setPasswordProtection(r.DISABLED);this.log(o.UI_ACTN_OPT_OUT_PASSWORD_PROTECTION_NUX);},handleErrorBackClick:function(){this.setState({saveErrorObject:null});},handleErrorOKClick:function(){this.setState({saveErrorObject:null});this.props.onComplete();},render:function(){if(this.state.saveErrorObject)return (s.createElement(k,{allowBack:true,title:ba._("Problem Saving"),onBackClick:this.handleErrorBackClick,onOKClick:this.handleErrorOKClick,error:this.state.saveErrorObject}));return (s.createElement(u,{className:h.messengerdotcom?"_-el":'',behaviors:{LayerFadeOnShow:false},layerHideOnBlur:false,shown:true,width:this.props.width},s.createElement(v,{showCloseButton:false},ba._("Use Password?")),s.createElement(w,null,s.createElement(y,{className:"_5sor",type:'primary'},ba._("For additional security, you can enter your Facebook password to send money. You can always update this in {link}.",[ba.param('link',s.createElement(i,{href:l.settingsWWWURI,target:'_blank'},ba._("Settings")))]))),s.createElement(x,null,s.createElement(t,{className:"_5sov",disabled:this.isCancelButtonDisabled(),label:ba._("Not Now"),onClick:this.onCancelClick,size:'medium',use:'default'}),s.createElement(t,{className:"_5sox",disabled:this.isSaveButtonDisabled(),label:ba._("Use Password"),onClick:this.onSaveClick,size:'medium',use:'confirm'})),s.createElement(m,{visible:this.state.loading})));}});f.exports=da;},null);
__d('P2PSuccessDialog.react',['CurrentEnvironment','Image.react','LayerSlowlyFadeOnShow','P2PConfirmationDialog.react','React','emptyFunction','fbt','ix'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){'use strict';if(c.__markCompiled)c.__markCompiled();var p=l.PropTypes,q=l.createClass({displayName:'P2PSuccessDialog',propTypes:{buttonLabel:p.node,buttonUse:p.string,onOKClick:p.func,onSecondaryClick:p.func,showCloseButton:p.bool,showSecondaryButton:p.bool,secondaryButtonLabel:p.node,secondaryButtonUse:p.string,title:p.string.isRequired},getDefaultProps:function(){return {allowBack:false,buttonLabel:n._("OK"),buttonUse:'default',onOKClick:m,showCloseButton:false,width:h.messengerdotcom?350:300};},getImage:function(){if(h.messengerdotcom){return (l.createElement(i,{height:62,width:62,src:o('/images/p2p/checkmark-messenger.png')}));}else return (l.createElement(i,{height:56,width:56,src:o('/images/p2p/check_mark-sm.png')}));},render:function(){var r=this.getImage();return (l.createElement(k,{behaviors:babelHelpers._extends({LayerSlowlyFadeOnShow:j},this.props.behaviors),allowBack:this.props.allowBack,buttonLabel:this.props.buttonLabel,buttonUse:this.props.buttonUse,centered:this.props.centered,image:r,onOKClick:this.props.onOKClick,onSecondaryClick:this.props.onSecondaryClick,showCloseButton:this.props.showCloseButton,showSecondaryButton:this.props.showSecondaryButton,secondaryButtonLabel:this.props.secondaryButtonLabel,secondaryButtonUse:this.props.secondaryButtonUse,title:this.props.title,width:this.props.width},this.props.children));}});f.exports=q;},null);
__d('P2PMoneypennyCheckoutDialogContainer.react',['Arbiter','CreditCardFormParam','CurrentEnvironment','MessengerPaymentProductType','MNCommerceAgenItemSuggestionReactShape','P2PAPI','P2PAPIUtils','P2PAddCreditCardDialog.react','P2PChooseCreditCardDialog.react','P2PCreditCardStore','P2PEditCreditCardDialog.react','P2PErrorDialog.react','P2PGKValues','P2PLogger','P2PMoneypennyCheckoutDialog.react','P2PMoneypennyStore','P2PPaymentLoggerEvent','P2PPaymentLoggerEventFlow','P2PPasswordProtectionNUXDialog.react','P2PPasswordProtectionStatusTypes','P2PSuccessDialog.react','P2PText.react','P2PVerifyCreditCardDialog.react','React','cx','fbt','setImmediate'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha){'use strict';if(c.__markCompiled)c.__markCompiled();var ia=ga._("Pay"),ja={LayerFadeOnShow:false},ka=360,la=y.UI_FLOW_MONEYPENNY_CHECKOUT,ma=ea.PropTypes,na=ea.createClass({displayName:'P2PMoneypennyCheckoutDialogContainer',propTypes:{item:l.isRequired,onClose:ma.func.isRequired},getInitialState:function(){var oa=this.getCards();return {addCreditCardDialogShown:false,editCreditCardDialogShown:false,creditCards:oa,creditCardAsyncRequestState:q.getAsyncRequestState(),chooseCreditCardDialogShown:false,loading:false,moneypennyAsyncRequestState:w.getAsyncRequestState(),p2pPasswordProtectionNUXDialogShown:false,transferErrors:null,transferRequestID:'',selectedCreditCard:oa[0],successDialogPending:false,successDialogShown:false,verifyCreditCardDialogShown:false};},componentWillMount:function(){this.log(x.UI_ACTN_INITIATE_MONEYPENNY_ORDER,{});this.creditCardStoreSub=q.addListener('change',this.onCreditCardStoreChange);this.moneypennyTransferStoreSub=w.addListener('change',this.onMoneypennyStoreChange);},componentWillUnmount:function(){if(this.creditCardStoreSub){this.creditCardStoreSub.remove();this.creditCardStoreSub=null;}if(this.moneypennyTransferStoreSub){this.moneypennyTransferStoreSub.remove();this.moneypennyTransferStoreSub=null;}if(this.passwordCancelSubscribeToken!==null){h.unsubscribe(this.passwordCancelSubscribeToken);this.passwordCancelSubscribeToken=null;}},creditCardStoreSub:null,moneypennyTransferStoreSub:null,passwordCancelSubscribeToken:null,passwordNUXPending:false,successDialogPending:false,getProductType:function(){return k.MESSENGER_COMMERCE;},getCards:function(){return q.getAll(this.getProductType());},log:function(oa,pa){u.log(oa,babelHelpers._extends({raw_amount:this.props.item.raw_amount,currency:this.props.item.total_cost.currency,object_id:this.props.item.id,www_event_flow:la},pa));},onCreditCardStoreChange:function(){var oa=this.getCards(),pa;if(this.state.selectedCreditCard)pa=q.getCreditCardByCredentialID(this.state.selectedCreditCard.getCredentialId());if(!pa)pa=oa[0];this.setState({creditCards:oa,creditCardAsyncRequestState:q.getAsyncRequestState(),selectedCreditCard:pa});},onMoneypennyStoreChange:function(){var oa=w.getAsyncRequestState(),pa=oa[this.state.transferRequestID];this.setState({moneypennyAsyncRequestState:oa});if(pa){this.setState({transferRequestID:''});if(pa.error){this.handleMoneypennyTransferError(pa.error);}else this.handleMoneypennyTransferSuccess(pa);}},handleChangeCreditCardClicked:function(){this.hideAllDialogs();if(this.state.creditCards.length>1){this.setState({chooseCreditCardDialogShown:true});this.log(x.UI_ACTN_INITIATE_CHOOSE_CARD,{});}else this.setState({addCreditCardDialogShown:true});},handleAddDebitCardClicked:function(){this.hideAllDialogs();this.setState({addCreditCardDialogShown:true});},handleCreditCardSelected:function(oa){this.setState({selectedCreditCard:oa},(function(){this.purchase();}).bind(this));},purchase:function(){var oa;if(!this.state.selectedCreditCard.getIsVerified()){this.log(x.UI_ACTN_VERIFY_CSC,{});this.hideAllDialogs();this.setState({verifyCreditCardDialogShown:true});return;}else if(this.state.selectedCreditCard.isExpired()){this.log(x.UI_ACTN_EDIT_CARD,{});this.hideAllDialogs();this.setState({editCreditCardDialogShown:true});return;}this.passwordCancelSubscribeToken=h.subscribeOnce('PasswordReauthDialogCancelClick',this.handlePasswordReauthDialogCancelClick);oa=n.genRequestID();this.setState({loading:true,transferRequestID:oa,transferErrors:null});m.createMoneypennyTransfer({amount:this.props.item.raw_amount,credential_id:this.state.selectedCreditCard.getCredentialId(),item_id:this.props.item.id,external_request_id:n.genRequestID(),requestID:oa});this.log(x.UI_ACTN_CONFIRM_MONEYPENNY_ORDER,{});},handleMoneypennyTransferSuccess:function(oa){this.hideAllDialogs();this.log(x.UI_ACTN_MONEYPENNY_ORDER_SUCCESS,{});if(oa.passwordProtection===aa.NOT_SET)this.passwordNUXPending=true;if(this.successDialogPending){this.successDialogPending=false;this.setState({successDialogShown:true});}else this.handleCheckoutSuccess();},handleMoneypennyTransferError:function(oa){this.hideAllDialogs();this.log(x.UI_ACTN_MONEYPENNY_ORDER_FAIL,{});this.setState({loading:false,transferErrors:oa});},handlePasswordReauthDialogCancelClick:function(){this.passwordCancelSubscribeToken=null;this.setState({loading:false});this.hideAllDialogs();},handleCheckoutSuccess:function(){this.hideAllDialogs();if(this.passwordNUXPending){this.passwordNUXPending=false;this.setState({p2pPasswordProtectionNUXDialogShown:true});}else ha(this.props.onClose);},handleAddCreditCardSuccess:function(oa){this.successDialogPending=this.getCards().length===1;this.setState({selectedCreditCard:q.getCreditCardByCredentialID(oa[i.CREDENTIAL_ID])},(function(){this.purchase();}).bind(this));},handleCheckoutCancel:function(){this.log(x.UI_ACTN_MONEYPENNY_ORDER_CANCEL,{});this.props.onClose();},hideAllDialogs:function(){this.setState({addCreditCardDialogShown:false,editCreditCardDialogShown:false,chooseCreditCardDialogShown:false,successDialogShown:false,transferErrors:null,verifyCreditCardDialogShown:false,p2pPasswordProtectionNUXDialogShown:false});},render:function(){var oa=this.props.item,pa=j.messengerdotcom,qa,ra,sa,ta,ua,va;if(this.getProductType()===k.MESSENGER_COMMERCE){qa=ga._("Please enter a debit or credit card to get {Product name}.",[ga.param('Product name',oa.name)]);ra=ga._("Add Card");ta=ga._("Select Card");sa=ga._("You can use a card you've already added to Facebook or add a new one to get {Product name}.",[ga.param('Product name',this.props.item.name)]);ua=ga._("New Card");va=ga._("You'll add a card next.");}else{qa=ga._("Please enter a debit card to get {Product name}. Credit cards can't be used yet.",[ga.param('Product name',oa.name)]);sa=ga._("You can use a debit card you've already added to Facebook or add a new one to get {Product name}.",[ga.param('Product name',this.props.item.name)]);}if(this.state.p2pPasswordProtectionNUXDialogShown){return (ea.createElement(z,{onComplete:this.props.onClose,width:ka}));}else if(this.state.transferErrors){return (ea.createElement(s,{behaviors:ja,error:this.state.transferErrors,onOKClick:this.handleCheckoutCancel,title:ga._("Problem with your payment"),width:ka}));}else if(this.state.verifyCreditCardDialogShown){return (ea.createElement(da,{asyncRequestState:this.state.creditCardAsyncRequestState,behaviors:ja,creditCard:this.state.selectedCreditCard,isPurchasing:true,purchaseName:this.props.item.name,onCancel:this.handleCheckoutCancel,onSuccess:this.purchase,saveButtonText:ia,showCancelButton:pa,width:ka}));}else if(this.state.editCreditCardDialogShown){return (ea.createElement(r,{asyncRequestState:this.state.creditCardAsyncRequestState,behaviors:ja,creditCard:this.state.selectedCreditCard,onCancel:this.handleCheckoutCancel,onSuccess:this.purchase,saveButtonText:ia,showCancelButton:pa,text:ga._("Please update the expiration date for your card ending in {card numbers} to get {Product name}.",[ga.param('card numbers',this.state.selectedCreditCard.getCreditCardNumber()),ga.param('Product name',this.props.item.name)]),width:ka}));}else if(this.state.successDialogShown){return (ea.createElement(ba,{behaviors:babelHelpers._extends({LayerSlowlyFadeOnShow:false},ja),onOKClick:this.handleCheckoutSuccess,title:ga._("Payment Sent"),width:ka},ea.createElement(ca,{className:"_3-97",type:'primary'},ga._("We received your payment and are placing your order with the business.")),ea.createElement(ca,{type:'primary'},ga._("{Bold text that says, Tip:} You can also use {Credit card name and number} to send money to friends in your conversations.",[ga.param('Bold text that says, Tip:',ea.createElement(ca,{display:'inline',type:'primary',weight:'bold'},ga._("Tip:"))),ga.param('Credit card name and number',this.state.selectedCreditCard.getDetailsFormatted())]))));}else if(this.state.chooseCreditCardDialogShown){return (ea.createElement(p,{addCardOptionText:ua,behaviors:ja,creditCards:this.state.creditCards,onAddDebitCardOptionSelected:this.handleAddDebitCardClicked,onClose:this.handleCheckoutCancel,onSelected:this.handleCreditCardSelected,saveButtonText:ia,selectedCreditCard:this.state.selectedCreditCard,showCancelButton:pa,showLoading:this.state.loading,text:sa,title:ta,width:ka}));}else if(this.state.addCreditCardDialogShown){return (ea.createElement(o,{behaviors:ja,eventFlow:la,loggingData:{amount:oa.raw_amount,object_id:oa.id},onCancel:this.handleCheckoutCancel,onSuccess:this.handleAddCreditCardSuccess,productType:this.getProductType(),saveButtonText:ia,showCancelButton:pa,text:qa,title:ra,width:ka}));}else return (ea.createElement(v,{item:this.props.item,leftContentText:va,onChangeCreditCard:this.handleChangeCreditCardClicked,onClose:this.handleCheckoutCancel,onNextClicked:this.handleAddDebitCardClicked,onPurchaseClicked:this.purchase,selectedCreditCard:this.state.selectedCreditCard,showCancelButton:pa,showLoading:this.state.loading,width:ka}));}});f.exports=na;},null);
__d('MNCommerceAgentItemSuggestionMercuryShareAttachment.react',['MercuryFallbackShareAttachment.react','MercuryShareAttachmentReactShape','MercuryShareAttachmentRenderLocations','MNCommerceAgentItemSuggestionMercuryAttachment.react','P2PActions','P2PMoneypennyCheckoutDialogContainer.react','P2PMoneypennyStore','React','ReactComponentWithPureRenderMixin','StoreAndPropBasedStateMixin'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){'use strict';if(c.__markCompiled)c.__markCompiled();var r=o.PropTypes,s=o.createClass({displayName:'MNCommerceAgentItemSuggestionMercuryShareAttachment',mixins:[p,q(n)],propTypes:{attachment:i,maxWidth:r.number,location:r.oneOf(j.getValues())},statics:{calculateState:function(t){var u=t.attachment&&t.attachment.target,v=!!(u&&u.payment_id);if(!v){var w=n.getTransferByID(u.id);v=!!(w&&w.payment_id);}return {isItemPurchased:v};}},_handleBuyClick:function(){l.showDialog(m,{item:this._getItem(),onClose:l.hideDialog});},_getItem:function(){var t=this.props.attachment;return t&&t.target;},render:function(){var t=this._getItem();if(!t)return o.createElement(h,this.props);return (o.createElement(k,{itemSuggestion:t,isPurchased:this.state.isItemPurchased,location:this.props.location,onBuyClick:this._handleBuyClick,width:this.props.maxWidth}));}});f.exports=s;},null);
__d('OzHelpers',['BanzaiScuba','DatePickerRestraints','ErrorUtils','getURLRanges','immutable','LogHistory','OzConstants','ReactComponentWithPureRenderMixin','React','URI'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){if(c.__markCompiled)c.__markCompiled();var r=l.List,s=l.Map,t=l.Set,u=l.OrderedMap,v=n.AUTHOR_TYPES,w=n.REMINDERS,x=/^image\//,y={blobURI:function(ja){return window.URL.createObjectURL(ja);},blobFromDataURI:function(ja){var ka=ja.split(','),la=atob(ka[1]),ma=ka[0].split(':')[1].split(';')[0],na=new ArrayBuffer(la.length),oa=new Uint8Array(na);for(var pa=0;pa<la.length;pa++)oa[pa]=la.charCodeAt(pa);return new Blob([na],{type:ma});},epochToLocaleDate:function(ja){return new Date(ja*1000).toLocaleDateString();},epochToLocaleTime:function(ja){return new Date(ja*1000).toLocaleTimeString();},hasCmdOrCtrl:function(ja){return ja.getModifierState('Meta')||ja.getModifierState('Control');},keysIn:function(){var ja=t(arguments);return function(ka,la){return ja.has(la);};},safeParse:function(ja){var ka={};try{ka=JSON.parse(ja);}catch(la){y.info('invalid json',ja);}return ka;},safeURI:function(ja){var ka=null;try{ka=q.isValidURI(ja)&&new q(ja)||null;}catch(la){y.info('invalid uri',ja);}return ka;},pure:z,memoize:aa,values:function(ja){return Object.keys(ja).map(function(ka){return ja[ka];});},debug:fa('debug',false),info:fa('info',true),warn:fa('warn',true),error:fa('error',true),isImageType:function(ja){return x.test(ja);},getConfig:da,setConfig:ea,dateRestraints:ba,threadID:function(ja){return ja.get('user-id');},isNew:function(ja){return !y.intents(ja).find(y.isClosedIntent);},hasOwner:function(ja){return ja.getIn(['owner','id']);},hasAllTags:function(ja,ka){return ka.every(function(la){return y.hasTag(ja,la);});},hasSomeTag:function(ja,ka){return ka.some(function(la){return y.hasTag(ja,la);});},hasTag:function(ja,ka){return ja.get('tags')&&ja.get('tags').contains(ka);},isEscalated:function(ja){return y.hasTag(ja,'escalated');},hasEngage:function(ja){return !!ja.get('engagement-type');},photo:function(ja){return ja.getIn(['user-vcard','photo'])||ja.getIn(['user-vcard','picture']);},compareNums:function(ja,ka){if(ja&&ka){return ka-ja;}else if(ja){return -1;}else if(ka){return 1;}else return 0;},compareBools:function(ja,ka){if(ja&&ka){return 0;}else if(ja){return -1;}else if(ka)return 1;},getIncomingThreads:function(ja){return ja.filter(function(ka){return ka.get('ready')&&!y.hasOwner(ka);}).sort(y.threadComparator);},threadComparator:function(ja,ka){var la=y.compareBools(y.hasTag(ja,'vip'),y.hasTag(ka,'vip')),ma=y.compareBools(y.hasTag(ja,'urgent'),y.hasTag(ka,'urgent')),na=y.compareNums(y.urgentReminders(ja).getIn([0,'scheduled-time']),y.urgentReminders(ka).getIn([0,'scheduled-time'])),oa=y.compareNums(ja.get('last-event-at'),ka.get('last-event-at'));return (la||ma||na||oa);},paymentURI:function(ja){return ja.get('user-fbid')?'https://our.intern.facebook.com/intern/support/review/'+('?id='+ja.get('user-fbid')+'&queue=156273444399031&type=123'):null;},lastEvents:function(ja){return ja.get('last-events',r()).sortBy(function(ka){return ka.get('timestamp');});},lastUserMessage:function(ja){var ka=y.lastEvents(ja).reverse();return ka.find(function(la){return y.authorType(la)===v.USER;})||ka.first();},shortDesc:function(ja){var ka=ja.getIn(['attachments',0,'mime_type']),la=ja.getIn(['attachments',0,'sticker_id']);return ja.get('text')||la&&'sent a sticker.'||ka&&(ka.match(/video/i)&&'sent a video.'||ka.match(/audio/i)&&'sent an audio clip.'||ka.match(/image/i)&&'sent an image');},preferredName:function(ja){return (ja.getIn(['metadata-json','preferred-name'])||ja.getIn(['user-vcard','first-name']));},intents:function(ja){return ja.get('intents',r()).sortBy(function(ka){return ka.get('created-at');});},isOwner:function(ja,ka){var la=ja.getIn(['owner','id']);return la&&ka&&la==ka;},wasOwner:function(ja,ka){var la=ja.getIn(['last-owner','id']);return la&&ka&&la==ka;},isLocker:function(ja,ka){return ja.get('locked')&&ja.get('locker-id')===ka;},nameOrId:function(ja){return ja&&(ja.get('name')||ja.get('id'))||'';},isSubscriber:function(ja,ka){return !!ja.get('subscriptions',r()).find(function(la){return la===ka;});},hasOpenIntents:function(ja){return ja.get('intents',r()).some(function(ka){return !y.isClosedIntent(ka);});},openIntents:function(ja){return y.intents(ja).filterNot(y.isClosedIntent);},isClosedIntent:function(ja){return ja.get('state')==='closed';},getName:function(ja){return ja.getIn(['user-vcard','name'],'Unknown user');},lastPresence:function(ja){return Math.max(ja.get('last-seen')||0,ja.get('last-presence')||0);},timeSpent:function(ja){if(ja.get('ready')&&ja.get('last-ready-at'))return Date.now()-ja.get('last-ready-at');},repName:function(ja,ka){var la=ka.get(ja);return la&&la.get('name')||ja||null;},authorType:function(ja){var ka=v.BOT,la=v.USER,ma=v.TRAINER,na=ja.get('sender')||ja.get('from'),oa=ja.get('author-type');return (oa===ka&&ka||(oa===ma||na===da('PAGE_ID'))&&ma||la);},msgID:function(ja){return ja.get('offline-threading-id')||ja.get('mid')||y.warn('[msgID] had to resort to timestamp',ja)&&null||ja.get('timestamp');},isActivePulse:function(ja){var ka=ja&&ja.get('pulse-data');if(!ka)return false;return !ka.get('away?')&&ka.get('inactive-ms',Infinity)<30000;},urgentReminders:function(ja){return ja.get('reminders',r()).sortBy(function(ka){return ka.get('scheduled-time');}).filter(y.isUrgentReminder);},paidReminders:function(ja){return y.urgentReminders(ja).filter(y.isPaidReminder);},isUrgentReminder:function(ja){var ka=ja.get('state');return ka==='active'||ka==='active-snoozed';},isPaidReminder:function(ja){return !!ja.getIn(['body','suggestion']);},isSnoozedReminder:function(ja){var ka=ja.get('state');return ka==='snoozed'||ka==='active-snoozed';},isUnread:function(ja){return ja.get('read-state')==='unread';},hasPaid:function(ja){return !!y.paidReminders(ja).size;},hasReminder:function(ja){return !!y.urgentReminders(ja).size;},minAge:function(ja){var ka=+ja.getIn(['user-vcard','age-range','min']);return Number.isSafeInteger(ka)?ka:0;},uiSuggestion:function(ja){var ka=ja.has('amount')?'$'+(ja.get('amount')/100).toFixed(2):'';return {id:ja.get('item-id')||'-1',name:ja.get('name'),desc:ja.get('description'),thumb_url:ja.get('thumb-url'),merchant_name:ja.get('merchant-name')||'',total_cost:ja.get('amount')?s({amount:ja.get('amount')}):null,display_total_cost:ka,target_url:ja.get('target-url')};},parsePhoneNumber:function(ja){if(!ja)return '';if(ja.length==12&&ja[0]=='+')ja=ja.substr(1);if(ja.length==11&&ja[0]=='1')ja=ja.substr(1);switch(ja.length){case 10:return '('+ja.substr(0,3)+') '+ja.substr(3,3)+'-'+ja.substr(6,4);case 7:return ja.substr(0,3)+'-'+ja.substr(3,4);default:return ja;}},validateURL:function(ja){return (!!ja&&typeof ja==='string'&&k(ja).length&&q.isValidURI(ja));},normalizeMerchant:function(ja){return ja.updateIn(['website'],function(ka){if(!ka)return ka;var la=k(ka);if(!la||la.length===0)return ka;return la[0].entity.url;}).updateIn(['page-id'],function(ka){if(Number.isFinite(ka)||typeof ka==='string')return parseInt(ka,10);return null;});},validateMerchant:function(ja){var ka=t(['name-dba','country']),la=t(['address','website','page-id']),ma={},na=ja.get('website','');if(na&&!this.validateURL(na))ma.website='Website is an invalid URL';var oa=ja.get('page-id',null);if(oa!=null&&!Number.isFinite(oa))ma['page-id']='FB Page must be a number';ka.map(function(qa){if(!ja.get(qa))ma[qa]='This field is required';});if(t(ja.filter(function(qa){return qa;}).keys()).intersect(la).isEmpty()){var pa='At least one of '+la.join(', ')+' is required';la.forEach(function(qa){ma[qa]=pa;});}return s(ma);}};function z(ja){var ka=arguments.length<=1||arguments[1]===undefined?'OzPureComponent':arguments[1];return (p.createClass({displayName:ka,mixins:[o],render:function(){return ja(this.props);}}));}function aa(ja,ka){var la=arguments.length<=2||arguments[2]===undefined?1000:arguments[2],ma=u();return (function(){for(var na=arguments.length,oa=Array(na),pa=0;pa<na;pa++)oa[pa]=arguments[pa];var qa=ka.apply(this,oa);if(ma.get(qa)){return ma.get(qa);}else{var ra=ja.apply(this,oa);ma=ma.set(qa,ra).takeLast(la);return ra;}}).bind(this);}function ba(){var ja=new Date(),ka=new Date(Date.UTC(ja.getFullYear(),ja.getMonth(),ja.getDate())),la=new Date(+ka);la.setFullYear(ka.getFullYear()+w.RANGE_IN_YEARS);return {dateRestraints:[i.enforceDateIsNoEarlierThan(ka),i.enforceDateIsNoLaterThan(la)]};}var ca={};function da(ja){return ca[ja];}function ea(ja){ca=ja;}j.addListener(function(ja){var ka=ia({level:'error',message:'[unhandled-error]['+ja.name+'] '+ja.message,data:ja.stack});ha(ka);ga(ka);});function fa(ja,ka){return function(){for(var la=arguments.length,ma=Array(la),na=0;na<la;na++)ma[na]=arguments[na];var oa=ma[0],pa=ma.slice(1);window.console.log(ja,oa,pa);var qa=ia({level:ja,message:oa,data:pa});ha(qa);ka&&ga(qa);};}function ga(ja){var ka=new h(da('scubaCategory'));Object.keys(ja).forEach(function(la){return ka.addNormal(la,ja[la]);});ka.post();}function ha(ja){var ka=m.getInstance('oz-logger');}function ia(ja){return babelHelpers._extends({},ja,{uid:da('uid'),public_name:da('publicName'),rev:da('rev')});}f.exports=y;},null);
__d('OzNotify',['immutable','ReactComponentWithPureRenderMixin','React','ReactCSSTransitionGroup','Reflux','cx','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n){if(c.__markCompiled)c.__markCompiled();var o=h.OrderedMap,p=h.Map,q={addNotif:l.createAction({sync:true}),removeNotif:l.createAction({sync:true})},r=l.createStore({init:function(){this.data=o();this.listenTo(q.addNotif,this._onAddNotif);this.listenTo(q.removeNotif,this._onRemoveNotif);},getInitialState:function(){return this.data;},_onAddNotif:function(y){this.data=this.data.set(y.get('id'),y);this.trigger(this.data);},_onRemoveNotif:function(y){this.data=this.data['delete'](y);this.trigger(this.data);}}),s=p({info:"_4nqo",warn:"_4nqp",error:"_4nqq"}),t=j.createClass({displayName:'OzNotify',mixins:[l.connect(r,'notifs'),i],render:function(){return (j.createElement(k,{component:'div',transitionName:'oz-fade-in-out',className:"_4nqr",transitionEnterTimeout:500,transitionLeaveTimeout:500},this.state.notifs.reverse().map(function(y,z){return (j.createElement('div',{key:z,className:n("_4nqs",s.get(y.get('level')))},y.get('msg')));}).valueSeq()));}}),u=7000,v=0;function w(y){return function(z){v+=1;q.addNotif(p({id:v,level:y,msg:z}));(function(aa){window.setTimeout(function(ba){return q.removeNotif(aa);},u);})(v);};}var x={Component:t,info:w('info'),warn:w('warn'),error:w('error')};f.exports=x;},null);
__d('OzActions',['Reflux'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i={};i.activateThread=h.createAction();i.updateThreads=h.createAction();i.maybeUpdateThreads=h.createAction();i.clearReassignState=h.createAction();i.updateMerchants=h.createAction();i.deleteMerchants=h.createAction();i.updateWitIntents=h.createAction();i.updateReps=h.createAction();i.replaceReps=h.createAction();i.replaceHumans=h.createAction();i.updateRequirements=h.createAction();i.showDialog=h.createAction();i.hideDialog=h.createAction();i.updateComposer=h.createAction();i.addBubble=h.createAction();i.addAutopilot=h.createAction();i.addScreenshot=h.createAction();i.isActive=h.createAction();i.isInactive=h.createAction();i.sendPulse=h.createAction();i.updateQueueFilters=h.createAction();i.twilio=h.createActions(['clearCall','connect','endCall','hangUp','hideDialog','incoming','incomingAccept','incomingReject','mute','ready','setup','showDialog','startCall','unmute','updateCallMeta','useIntent','sendDigits']);i.twilio.changeTo=h.createAction({sync:true});i.sendMessageStart=h.createAction();i.sendMessageFinish=h.createAction();f.exports=i;},null);
__d('OzAPI',['OzHelpers','OzNotify','Arbiter','ChannelConstants','ChannelManager','immutable','invariant','OzActions','OzAJAX','OzConfig','promiseFinally','RTISubscriptionManager'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){if(c.__markCompiled)c.__markCompiled();var t=m.List,u=m.Map,v=p.ajax,w=p.beacon,x=p.buildURI;l.getConfig;function y(ja){if(ja.attachment&&!ja.attachments)ja.attachments=[ja.attachment];var ka=m.fromJS(ja);return ka;}function z(ja){return t(ja.map(function(ka){ka=y(ka);return [h.msgID(ka),ka];})).fromEntrySeq().toMap();}function aa(ja){if(!ja.messages)ja.messages=(ja['last-events']||[]).map(function(la){la.sender=la.from;return la;});ja.messages=z(ja.messages);var ka=m.fromJS(ja);return ka;}function ba(ja){return t(ja.map(aa));}function ca(ja){var ka=ba([ja]);o.updateThreads(ka);!(ka.count()===1)?n(0):undefined;return ka.first();}function da(ja){!Number.isSafeInteger(ja.offset)?n(0):undefined;!Number.isSafeInteger(ja.limit)?n(0):undefined;return v({type:'GET',url:x('threads',h.getConfig('PAGE_ID')),params:ja}).then(function(ka){var la=ka.threads,ma=ba(la);o.updateThreads(ma);return ma;});}function ea(ja){var ka=arguments.length<=1||arguments[1]===undefined?{}:arguments[1],la=arguments.length<=2||arguments[2]===undefined?{}:arguments[2];!(typeof ja==='string')?n(0):undefined;!(typeof ka==='object')?n(0):undefined;var ma,na=false;if(ka instanceof FormData){ma=ka;}else{ma=JSON.stringify(ka);na=true;}var oa={type:'PUT',url:x('sync'),params:{t:ja,page:h.getConfig('PAGE_ID')},body:ma};oa=Object.assign(oa,la);if(na){oa.headers=oa.headers||{};oa.headers['content-type']='application/json';}h.info('[sync] '+ja,ka);return v(oa);}function fa(ja){return function(ka){return ea(ja,{tid:ka}).then(function(la){var ma=aa(la);o.updateThreads(t([ma]));return ma;});};}var ga={_witIntentCSV:function(){ga.witIntents().done(function(ja){var ka='data:text/csv;charset=utf-8,';ja.forEach(function(la){return ka+=la.get('name')+','+la.get('id')+'\n';});window.open(window.encodeURI(ka));});},grab:fa('grab'),release:fa('release'),ready:fa('ready'),notready:fa('notready'),ack:fa('ack'),lockThread:fa('lock-thread'),unlockThread:function(ja,ka){return ea('unlock-thread',{tid:ja,'locked-at':ka}).then(ca);},assignTo:function(ja,ka){return ea('assign-to',{tid:ja,id:ka});},escalate:function(ja){return ga.createTag(ja,'escalated');},escalateTo:function(ja,ka){return ga.escalate(ja).then(function(){return ga.assignTo(ja,ka);});},typing:function(ja){return ea('rep-typing',{tid:ja});},createReminder:function(ja,ka){return ea('create-reminder',babelHelpers._extends({tid:ja},ka.toJS())).then(ca);},closeReminder:function(ja,ka,la){return ea('close-reminder',{tid:ja,id:ka,all:la}).then(ca);},editReminder:function(ja,ka){return ea('edit-reminder',{tid:ja,reminder:ka.toJS()}).then(ca);},snoozeReminder:function(ja,ka){return ea('snooze-reminder',{tid:ja,id:ka}).then(ca);},deleteIntentRequirement:function(ja,ka,la){return ea('delete-intent-requirement',{tid:ja,'intent-id':ka,'requirement-id':la}).then(ca);},deleteThreadRequirement:function(ja,ka){return ea('delete-thread-requirement',{tid:ja,'requirement-id':ka}).then(ca);},createIntentRequirement:function(ja,ka,la){return ea('create-intent-requirement',{tid:ja,'intent-id':ka,'requirement-name':la}).then(ca);},createThreadRequirement:function(ja,ka){return ea('create-thread-requirement',{tid:ja,'requirement-name':ka}).then(ca);},createIntent:function(ja,ka){return ea('create-intent',babelHelpers._extends({tid:ja},ka.toJS())).then(ca);},deleteIntent:function(ja,ka){return ea('delete-intent',{tid:ja,id:ka}).then(ca);},openIntent:function(ja,ka){return ea('open-intent',{tid:ja,id:ka}).then(ca);},closeIntent:function(ja,ka){return ea('close-intent',{tid:ja,id:ka}).then(ca);},addPhoneNumber:function(ja,ka){return ea('add-phone-number',{tid:ja,'intent-id':ka}).then(ca);},editIntent:function(ja,ka){return ea('edit-intent',babelHelpers._extends({tid:ja},ka.toJS()));},createTag:function(ja,ka){return ea('add-thread-tag',{tid:ja,tag:ka}).then(ca);},deleteTag:function(ja,ka){return ea('remove-thread-tag',{tid:ja,tag:ka}).then(ca);},view:fa('create-subscription'),unview:fa('delete-subscription'),updateMessage:function(ja,ka){return ea('update-message',{tid:ja,message:ka.toJS()}).then(ca);},sendMessage:function(ja){var ka=ea('send',ia(ja)).then(function(la){return ca({'user-id':ja.tid,'last-events':la});});r(ka,function(la){return o.sendMessageFinish(ja.tid);});window.setTimeout(function(){return o.sendMessageStart(ja.tid);},200);return ka;},scheduleMessage:function(ja){return ea('schedule-send',ia(ja)).then(ca);},suggest:function(ja){return ea('suggest',ja).then(ca);},scheduleSuggest:function(ja){return ea('schedule-suggest',ja).then(ca);},deleteScheduled:function(ja,ka){return ea('delete-scheduled',{tid:ja,id:ka}).then(ca);},saveNote:function(ja,ka){var la={tid:ja,infos:{notes:ka}};return ea('update-infos',la).then(ca);},saveMeta:function(ja,ka){var la={tid:ja,infos:{'metadata-json':ka.toJS()}};return ea('update-infos',la).then(ca);},saveMuted:function(ja,ka){var la={tid:ja,infos:{muted:ka}};return ea('update-infos',la).then(ca);},createMerchant:function(ja){return ea('create-merchant',ja.toJS()).then(function(ka){var la=t([u(ka)]);o.updateMerchants(la);return la;});},editMerchant:function(ja){return ea('edit-merchant',ja.toJS()).then(function(ka){var la=t([u(ka)]);o.updateMerchants(la);return la;});},deleteMerchant:function(ja){return ea('delete-merchant',ja.toJS()).then(function(ka){if(ka&&ka.id){var la=t([ka.id]);o.deleteMerchants(la);return la;}else h.warn('[api] unexpected delete-merchant response',ka);});},witIntents:function(){return v({type:'GET',url:x('wit-intents',h.getConfig('PAGE_ID'))}).then(function(ja){var ka=m.fromJS(ja);o.updateWitIntents(ka);return ka;});},merchants:function(){return v({type:'GET',url:x('merchants')}).then(function(ja){o.updateMerchants(t(ja).map(function(ka){return u(ka);}));});},repsSync:function(){return v({type:'GET',url:x('reps-sync')});},requirements:function(){return v({type:'GET',url:x('requirements')}).then(function(ja){o.updateRequirements(m.fromJS(ja));});},AIModules:function(){return v({type:'GET',url:x('ai-modules')}).then(function(ja){return t(ja);});},authorFeedback:function(ja){return v({type:'GET',url:x('author-feedback'),params:{author_id:ja}}).then(function(ka){return u(ka.map(function(la){la=m.fromJS(la);return [h.msgID(la),la];}));});},myThreads:function(){var ja=h.getConfig('PAGE_ID');return v({type:'GET',params:{page:ja},url:x('mythreads')}).then(function(ka){var la=ka.mythreads;o.updateThreads(ba(la));});},allThreads:function(ja,ka,la,ma){var na={all:true,first_tags:ja.toJS(),last_tags:ka.toJS(),offset:la,limit:ma};if(ja.has('ready')){ja=ja['delete']('ready');na.ready=true;}else if(ka.has('ready')){ka=ka['delete']('ready');na.ready=false;}return da(na);},thread:function(ja){return v({type:'GET',url:x('threads',h.getConfig('PAGE_ID'),ja)}).then(ca);},history:function(ja,ka,la){return v({type:'GET',params:{timestamp:ka,limit:la},url:x('threads',h.getConfig('PAGE_ID'),ja,'history')}).then(function(ma){var na=ca({'user-id':ja,messages:ma});return na.get('messages');});},topIntents:function(){return v({type:'GET',url:x('top-intents')}).then(function(ja){return m.fromJS(ja);});},intentsDashboard:function(ja){return v({type:'GET',params:ja,url:x('dashboard','intent',h.getConfig('PAGE_ID'))}).then(function(ka){return m.fromJS(ka);});},aiDashboard:function(ja){return v({type:'GET',params:ja,url:x('dashboard','ai',h.getConfig('PAGE_ID'))}).then(function(ka){return m.fromJS(ka);});},statsDashboard:function(ja){return v({type:'GET',params:ja,url:x('dashboard','trainer',ja['trainer-id'])}).then(function(ka){return m.fromJS(ka);});},teamStatsDashboard:function(ja){return v({type:'GET',params:ja,url:x('dashboard','trainer-team-stats')}).then(function(ka){return m.fromJS(ka);});},humans:function(){return v({type:'GET',url:x('humans')}).then(function(ja){return o.replaceHumans(m.fromJS(ja));});},requestScreenshot:function(ja){window.postMessage(babelHelpers._extends({type:'screenshot-req'},{data:ja}),'*');},requestAutopilot:function(ja){window.postMessage(ja,'*');},notifyExtension:function(ja){h.debug('[oz-ext] notifying toto',ja);window.postMessage(babelHelpers._extends({type:'notification'},{data:ja}),'*');},recordActivity:function(ja,ka){return ea('activity',babelHelpers._extends({tid:ja},{activity:ka}));},sendPulse:function(ja,ka){return v({type:'POST',url:x('pulse'),headers:{'content-type':'application/json'},params:{page:h.getConfig('PAGE_ID'),duration:ja},body:JSON.stringify(ka)});},sendDisconnectPulse:function(ja,ka){return w({url:x('pulse'),params:{page:h.getConfig('PAGE_ID'),duration:ja},body:JSON.stringify(ka)});},threadFocus:function(ja,ka){return ea('thread-focus',babelHelpers._extends({tid:ja},{intentID:ka}));},away:function(ja){return ea('away',{away:ja});},coachMode:function(ja){return ea('coach-mode',{'coach-mode':ja});},init:function(){return v({type:'GET',url:x('init')}).then(function(ja){ja['twilio-token']&&o.twilio.setup(ja['twilio-token']);});},realTime:function(ja,ka){var la,ma=60000,na=function(){var sa=Date.now();clearInterval(la);la=setInterval(function(ta){var ua=Math.round((Date.now()-sa)/1000);h.warn('[rti] no payload in '+ua+'seconds');i.warn('We have not received anything from the server in '+ua+'           seconds. You may want to refresh the page.');},ma);},oa={repsVersion:-1},pa=function(sa,ta){var ua=ta.payload,va=ta.topic;!(sa==='sky'||sa==='msg')?n(0):undefined;na();var wa,xa,ya=sa==='sky'?sa+' '+va+' ->':sa,za=ua.type,ab=za||'';h.debug('[rti] '+ya+' '+ab,ua);if(!ua.data){h.error('[sky] got sky event without data',ua,va);return;}xa=ua.data['page-id'];if(xa&&xa!==h.getConfig('PAGE_ID')){h.debug('[sky] junk event on '+va,ua);return;}switch(za){case 'thread':wa=ua.data;ca(wa);break;case 'maybe-thread':wa=ua.data;o.maybeUpdateThreads(ba([wa]));break;case 'delivered':case 'seen':wa=ua.data;ca({'user-id':wa['user-id'],'last-seen':wa['last-seen']});break;case 'presence':wa=ua.data;ca({'user-id':wa['user-id'],'last-presence':wa['last-presence']});break;case 'carebear':(function(){var bb=ua.data,cb=bb.type,db=bb.tid,eb={'user-id':db};eb['ui-'+cb]=true;ca(eb);})();break;case 'inactive':o.isInactive();break;case 'updated-merchant':o.updateMerchants(t([u(ua.data)]));break;case 'deleted-merchant':o.deleteMerchants(t([ua.data.id]));break;case 'phone-call':if(q.GK.voip)o.twilio.updateCallMeta(m.fromJS(ua.data));break;case 'humans':o.replaceHumans(m.fromJS(ua.data));break;case 'reps-sync':oa=babelHelpers._extends({},oa,{repsVersion:ua.version});o.replaceReps(m.fromJS(ua.data));break;case 'reps-diff':if(oa.repsVersion!==ua.version-1){h.warn('[api] reps version out of sync',{'our-version':oa.repsVersion,'next-version':ua.version});oa=babelHelpers._extends({},oa,{repsVersion:-1});ga.repsSync();}else{oa.repsVersion=ua.version;o.updateReps(m.fromJS(ua.data));}break;default:h.debug('[sky] unk type',za,ua);}},qa=j.subscribe(k.getArbiterType('msg'),function(sa,ta){pa('msg',ta.obj);}),ra=ha(function(){j.unsubscribe(qa);s.unsubscribeAll();});s.subscribe(ja,pa.bind(this,'sky'),null,ha(function(sa){var ta=sa.data,ua=sa.error;if(ua){ra();ka(ua,ta);}else{na();ka(null,ta,qa);}}));return ra;}};function ha(ja){var ka,la,ma=this;return function(){if(!ka){la=ja.apply(ma,arguments);ka=true;}return la;};}function ia(ja){var ka=new FormData();ka.append('tid',ja.tid);ja.text&&ka.append('text',ja.text);ja.images&&ja.images.forEach(function(la){return (ka.append('images',la instanceof Blob?la:JSON.stringify(la)));});ja.stickerID&&ka.append('sticker_id',ja.stickerID);ja.aiusage&&ka.append('aiusage',JSON.stringify(ja.aiusage));ja.at&&ka.append('at',ja.at);ja.external_images&&ka.append('external_images',JSON.stringify(ja.external_images));return ka;}f.exports=ga;},null);
__d('OzEditorStateHelpers',['ContentState','createPlainBlocksFromText','OzHelpers','DraftModifier','EditorState','UnicodeUtils'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();function n(y,z){var aa=i([z]),ba=h.createFromBlockArray(aa),ca=l.push(y,ba,'remove-range');ca=l.forceSelection(ca,ca.getSelection());return ca;}function o(y){var z=y.getCurrentContent().getBlockMap(),aa=y.getSelection().getStartKey();return z.get(aa);}function p(y,z){return y.getCurrentContent().getPlainText().indexOf(z)>=0;}function q(y){var z=w(y,function(aa){var ba=aa.getSelection();if(ba.getStartOffset()===0)return x(aa,1);var ca=o(aa).getText().length;return ba.merge({anchorOffset:ca,focusOffset:0,isBackward:true});},'backward');if(z===y.getCurrentContent())return y;return l.push(y,z,'remove-range');}function r(y,z){var aa=y.getCurrentContent(),ba=o(y).getText(),ca=y.getSelection().merge({anchorOffset:0,focusOffset:ba.length}),da=k.replaceText(aa,ca,z);j.debug('[replaceLine]',z,ba,da.getPlainText());if(da===aa)return y;return l.push(y,da,'remove-range');}function s(y,z){var aa=y.getCurrentContent(),ba=k.insertText(aa,aa.getSelectionAfter(),z);if(ba===aa)return y;return l.push(y,ba,'insert-characters');}function t(y,z){var aa=o(y).getText(),ba=aa.length;if(ba===0)return false;z=Math.min(z,ba-1);return aa[z];}function u(y,z){var aa=y.getSelection().merge({focusOffset:z,anchorOffset:z});return l.forceSelection(y,aa);}function v(y,z){var aa=w(y,function(ca){var da=ca.getSelection(),ea=ca.getCurrentContent(),fa=da.getAnchorKey(),ga=da.getAnchorOffset(),ha=ea.getBlockForKey(fa).getText().slice(ga-z,ga);return x(ca,ha?m.strlen(ha):1);},'backward');if(aa===y.getCurrentContent())return y;aa=aa.set('selectionBefore',y.getSelection());var ba=y.getSelection().isCollapsed()?'backspace-character':'remove-range';return l.push(y,aa,ba);}function w(y,z,aa){var ba=y.getSelection(),ca=y.getCurrentContent(),da=ba;if(ba.isCollapsed()){if(aa==='forward'){if(y.isSelectionAtEndOfContent())return ca;}else if(y.isSelectionAtStartOfContent())return ca;da=z(y);if(da===ba)return ca;}return k.removeRange(ca,da,aa);}function x(y,z){var aa=y.getSelection(),ba=y.getCurrentContent(),ca=aa.getStartKey(),da=aa.getStartOffset(),ea=ca,fa=0;if(z>da){var ga=ba.getKeyBefore(ca);if(ga==null){ea=ca;}else{ea=ga;var ha=ba.getBlockForKey(ga);fa=ha.getText().length;}}else fa=da-z;return aa.merge({focusKey:ea,focusOffset:fa,isBackward:true});}f.exports={append:s,backspaceTimes:v,charAt:t,currentBlock:o,deleteCurrentLine:q,editorStateHas:p,forceCollapsedSelection:u,replaceContentWithText:n,replaceLine:r};},null);
__d('OzHistory',['invariant','immutable'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j=i.List,k=i.OrderedMap,l='oz-history',m=10,n=100;function o(){return k(JSON.parse(localStorage.getItem(l)||'{}')).map(function(t){return j(t);});}function p(t){!k.isOrderedMap(t)?h(0):undefined;return localStorage.setItem(l,JSON.stringify(t));}function q(t){var u=o();if(u.has(t))return;p(u.set(t,[]).takeLast(m));}function r(t){var u={},v={items:function(){if(!u.items)u.items=o().get(t);return u.items;},persist:function(w){!j.isList(w)?h(0):undefined;p(o().set(t,w));u.items=w;v.resetPos();},resetPos:function(){u.pos=v.items().size;},pos:function(){if(!Number.isSafeInteger(u.pos))v.resetPos();return u.pos;},dec:function(){u.pos=Math.max(v.pos()-1,0);},inc:function(){u.pos=Math.min(v.pos()+1,v.items().size);},val:function(){return v.items().get(v.pos());}};return v;}function s(t){q(t);var u=r(t);return {up:function(){u.dec();return u.val();},down:function(){u.inc();return u.val();},push:function(v){var w=u.items();if(!v||w.last()===v)return;u.persist(w.push(v).takeLast(n));}};}f.exports=s;},null);
__d('OzDialogContainer.react',['OzStores','React','ReactLayeredComponentMixin','Reflux'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l=h.DialogStore,m=i.createClass({displayName:'OzDialogContainer',mixins:[k.connect(l,'dialog'),j],renderLayers:function(){var n=this.state.dialog.dialogClass;if(n){var o=this.state.dialog.dialogProps||{};return {dialog:i.createElement(n,babelHelpers._extends({ref:'dialog'},o))};}return {};},render:function(){return null;}});f.exports=m;},null);
__d('OzLoading.react',['MessengerFlexArea.react','MessengerSpinner.react','React','cx'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l=j.PropTypes,m=j.createClass({displayName:'OzLoading',propTypes:{message:l.node,color:l.oneOf(["grey","blue"])},getDefaultProps:function(){return {color:"blue"};},render:function(){return (j.createElement('div',{className:"_30r7"},j.createElement(i,{color:this.props.color}),j.createElement('div',{className:"_30r8"},this.props.message)));}});m.Inline=j.createClass({displayName:'Inline',propTypes:{loading:l.bool.isRequired},render:function(){var n=this.props,o=n.loading,p=babelHelpers.objectWithoutProperties(n,['loading']);if(!o)return null;return (j.createElement('div',{className:"_nkb"},j.createElement(m,p)));}});m.Flex=j.createClass({displayName:'Flex',render:function(){return (j.createElement(h,null,j.createElement(m,this.props)));}});f.exports=m;},null);
__d('OzHeader.react',['OzHelpers','immutable','Layout.react','OzButton.react','OzConfig','OzHumans','OzReps','OzStores','OzSwitch.react','OzTwilio','React','Reflux','ReactRouter','Tooltip','cx'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){if(c.__markCompiled)c.__markCompiled();var w=i.Map,x=o.RepStore,y=o.HumanStore,z=t.Link,aa=r.PropTypes,ba=h.pure(function(da){var ea=da.reps,fa=da.humans,ga=da.uid,ha=ea.get(ga,w()),ia=n.closedIntentCount(ha),ja=n.teamClosedIntentCount(ha,ea),ka=Math.round(m.avgLoad(fa)),la=fa.filter(m.isWorking).count();return (r.createElement('span',{className:"_3fr"},r.createElement('span',{className:"_3fs"},r.createElement('span',u.propsFor('Your closed intents'),ia),' ',r.createElement('span',u.propsFor('Closed intents for your entire team'),'(',ja,')')),'intents closed',r.createElement('span',{className:"_3fs"},ka),'avg load',r.createElement('span',{className:"_3fs"},la),la===1?'trainer':'trainers'));}),ca=r.createClass({displayName:'OzHeader',mixins:[t.Navigation,t.State,s.connect(y,'humans'),s.connect(x,'reps')],propTypes:{coachMode:aa.bool.isRequired,rev:aa.number.isRequired,version:aa.string.isRequired,onAway:aa.func.isRequired,onCoachModeToggle:aa.func.isRequired},contextTypes:{uid:aa.string.isRequired},render:function(){var da=this.getParams().threadid?'inbox/show':'inbox',ea=this.state.humans.getIn([this.context.uid,'load'],0),fa='Inbox'+(ea?' ('+ea+')':''),ga=this.props.rev+'/'+this.props.version;return (r.createElement(j,{className:"_2d86"},r.createElement('div',{className:"_2d87"},r.createElement('span',{className:"_2d88",title:ga},'Oz'),this._renderItem(fa,da),this._renderItem('Merchants','merchants'),this._renderItem('Feedback','feedback'),this._renderItem('Stats','stats'),l.GK.supervisor&&this._renderItem('Top','top'),l.GK.IntentDashboard&&this._renderItem('Intents','intents'),l.GK.AIDashboard&&this._renderItem('AI','ai'),l.GK.supervisor&&this._renderItem('Trainers','trainers'),this._renderItem('All Threads','all')),r.createElement('div',{className:"_j6m"},r.createElement(ba,{humans:this.state.humans,reps:this.state.reps,uid:this.context.uid}),l.GK.supervisor?r.createElement(p,{className:"_b8c",isAnimated:true,isOn:this.props.coachMode,label:'Coach Mode',onToggle:this.props.onCoachModeToggle}):null,l.GK.voip?r.createElement(q,null):null,!this.props.away?r.createElement(k,{onClick:this.props.onAway},'I\'m going away'):null)));},_renderItem:function(da,ea){return (r.createElement(z,{to:ea,params:this.getParams()},da));}});f.exports=ca;},null);
__d('OzAIDashboardFilters.react',['immutable','InputLabel.react','ReactComponentWithPureRenderMixin','React','XUISingleSelector.react','cx'],function a(b,c,d,e,f,g,h,i,j,k,l,m){'use strict';if(c.__markCompiled)c.__markCompiled();var n=h.List,o=h.Map,p=k.PropTypes,q=l.Option,r=k.createClass({displayName:'OzAIDashboardFilters',mixins:[j],propTypes:{intentMetas:p.instanceOf(o).isRequired,modules:p.instanceOf(n).isRequired,isReversed:p.bool.isRequired,onIsReversedChange:p.func.isRequired,onSortByChange:p.func.isRequired,onUUIDChange:p.func.isRequired,onModuleChange:p.func.isRequired,sortBy:p.string,sortableFields:p.instanceOf(o).isRequired,uuid:p.string,selectedModule:p.string},render:function(){return (k.createElement('ul',{className:"_1bo-"},k.createElement('li',null,this._renderModuleFilter()),k.createElement('li',null,this._renderUUIDFilter()),k.createElement('li',null,this._renderSortByFilter()),k.createElement('li',null,this._renderIsReversedFilter())));},_renderModuleFilter:function(){return (k.createElement(l,{maxheight:400,onChange:this._handleModuleChange,value:this.props.selectedModule||'__none__'},k.createElement(q,{value:'__none__'},'Select a module'),this.props.modules.valueSeq().map(function(t){return (k.createElement(q,{key:t,value:t},t));})));},_renderUUIDFilter:function(){return (k.createElement(l,{maxheight:400,onChange:this._handleUUIDChange,value:this.props.uuid||'__none__'},k.createElement(q,{value:'__none__'},'Select an intent category'),this.props.intentMetas.sortBy(function(t){return t.get('name');}).valueSeq().map(function(t){return (k.createElement(q,{key:t.get('id'),value:t.get('id')},t.get('name')));})));},_renderIsReversedFilter:function(){return (k.createElement(i,null,k.createElement('input',{checked:this.props.isReversed,onChange:(function(t){this.props.onIsReversedChange(t.target.checked);}).bind(this),type:'checkbox'}),k.createElement('label',null,'Reversed?')));},_renderSortByFilter:function(){return (k.createElement(l,{maxheight:400,onChange:this._handleSortByChange,value:this.props.sortBy||'__none__'},k.createElement(q,{value:'__none__'},'Select a field to sort by'),this.props.sortableFields.map(function(t,u){return (k.createElement(q,{key:u,value:u},t));}).valueSeq()));},_handleSortByChange:function(t){this.props.onSortByChange(s(t.value));},_handleUUIDChange:function(t){this.props.onUUIDChange(s(t.value));},_handleModuleChange:function(t){this.props.onModuleChange(t.value);}});function s(t){return t!=='__none__'?t:undefined;}f.exports=r;},null);
__d('OzAIDashboardEventSuggestions.react',['cx','immutable','OzConstants','ReactComponentWithPureRenderMixin','React','XUITable.react'],function a(b,c,d,e,f,g,h,i,j,k,l,m){'use strict';if(c.__markCompiled)c.__markCompiled();var n=i.List,o=i.Map,p=j.ATTS,q=l.PropTypes,r=l.createClass({displayName:'OzAIDashboardEventSuggestions',mixins:[k],propTypes:{gold:q.instanceOf(o).isRequired,guesses:q.instanceOf(n).isRequired},render:function(){return (l.createElement(m,{outerBorder:true},l.createElement('thead',null,l.createElement('tr',null,l.createElement('th',null,'Source'),l.createElement('th',null,'Guess'),l.createElement('th',null,'Class'),l.createElement('th',null,'Confidence'))),l.createElement('tbody',null,this._getSuggestions().map(this._renderRow))));},_buildGuess:function(s){switch(s.get('type')){case p.TEMPLATE:return (l.createElement('span',null,s.get('ui-body')||JSON.stringify(s.get('body'))));case p.SUGG:case 'bubble':return (l.createElement('a',{href:s.get('target-url'),target:'_blank'},s.get('name')));case p.SCREENSHOT:return l.createElement('a',{href:s.get('url'),target:'_blank'},'Screenshot url');default:return l.createElement('span',null,JSON.stringify(s));}},_renderRow:function(s,t){var u=this.props.gold,v=s.get('source');return (l.createElement('tr',{className:u.get('source')===v&&u.get('position')===s.get('position')?"_31bp":'',key:t},l.createElement('td',null,v),l.createElement('td',null,this._buildGuess(s)),l.createElement('td',null,s.get('class')),l.createElement('td',null,s.get('confidence'))));},_getSuggestions:function(){return this.props.guesses.flatMap(function(s){return s.get('items')||[s].map(function(t){return t.merge(o({position:s.get('position'),confidence:s.get('confidence'),'class':s.get('class')}));});}).toSeq();}});f.exports=r;},null);
__d('OzAIDashboardEventsDialog.react',['DialogFitHeight','immutable','InputLabel.react','OzAIDashboardEventSuggestions.react','ReactComponentWithPureRenderMixin','React','XUIDialog.react','XUIDialogBody.react','XUIDialogFooter.react','XUIDialogOkayButton.react','XUIDialogTitle.react','XUITable.react','cx','formatDate'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){'use strict';if(c.__markCompiled)c.__markCompiled();var v=i.Map,w=m.PropTypes,x=m.createClass({displayName:'OzAIDashboardEventsDialog',mixins:[l],propTypes:{session:w.instanceOf(v).isRequired,onToggle:w.func.isRequired,shown:w.bool.isRequired},getInitialState:function(){return {isFiltered:true};},render:function(){return (m.createElement(n,{behaviors:{DialogFitHeight:h},onToggle:this.props.onToggle,shown:this.props.shown,width:800},m.createElement(r,null,m.createElement('span',null,'Events for Session ',this.props.session.get('id'))),m.createElement(o,null,m.createElement(j,null,m.createElement('input',{checked:this.state.isFiltered,onChange:(function(aa){this.setState({isFiltered:aa.target.checked});}).bind(this),type:'checkbox'}),m.createElement('label',null,'Filter Non-Message Events?')),this._renderTable()),m.createElement(p,null,m.createElement(q,{use:'confirm',action:'cancel'}))));},_renderTable:function(){return (m.createElement(s,{className:"_4p5_",outerBorder:true},m.createElement('thead',null,m.createElement('tr',null,m.createElement('th',null,'Time'),m.createElement('th',null,'Text/Data'),m.createElement('th',null,'Suggestions'),m.createElement('th',null,'Winner'))),m.createElement('tbody',null,this._getEvents().map(this._renderRow))));},_renderRow:function(event,aa){var ba=event.get('type'),ca=event.getIn(['aiusage','guesses']),da=event.get('suggestion');return (m.createElement('tr',{key:aa},m.createElement('td',{className:"_4p60"},y(event.get('time'))),m.createElement('td',{className:"_4p61"+(ba!=='message'?' '+"_31bp":'')},event.get('text')||da&&z(da)),m.createElement('td',null,ca?m.createElement(k,{gold:event.getIn(['aiusage','gold'])||v(),guesses:ca}):''),m.createElement('td',null,event.getIn(['aiusage','gold','source']))));},_getEvents:function(){var aa=this.props.session.get('events').toSeq();if(this.state.isFiltered)aa=aa.filter(function(event){var ba=event.get('type');return ba==='send'||ba==='message'||ba==='suggest';});return aa;}});function y(aa){return u(aa/1000,'M d, Y g:ia');}function z(aa){return (m.createElement('a',{href:aa.get('target-url'),target:'_blank'},aa.get('name')));}f.exports=x;},null);
__d('OzAIDashboardRow.react',['immutable','ReactLayeredComponentMixin','OzAIDashboardEventsDialog.react','ReactComponentWithPureRenderMixin','React','formatDate'],function a(b,c,d,e,f,g,h,i,j,k,l,m){'use strict';if(c.__markCompiled)c.__markCompiled();var n=h.Map,o=l.PropTypes,p=l.createClass({displayName:'OzAIDashboardRow',mixins:[i,k],propTypes:{session:o.instanceOf(n).isRequired,intentMeta:o.instanceOf(n),selectedModule:o.string},getInitialState:function(){return {isDialogOpen:false};},render:function(){var r=this.props,s=r.session,t=r.intentMeta,u=r.selectedModule;return (l.createElement('tr',null,l.createElement('td',null,s.get('id')),l.createElement('td',null,q(s.get('created-at'))),l.createElement('td',null,t&&t.get('name')),l.createElement('td',null,s.get('sends')||0),l.createElement('td',null,s.get('texts')||0),l.createElement('td',null,s.get('suggs')||0),l.createElement('td',null,s.get('humans')||0),l.createElement('td',null,s.getIn(['shown',u])||0),l.createElement('td',null,s.getIn(['won',u])||0),l.createElement('td',null,this._renderEventsLink())));},renderLayers:function(){if(!this.state.isDialogOpen)return {};return {dialog:l.createElement(j,{session:this.props.session,onToggle:this._handleDialogToggle,shown:this.state.isDialogOpen})};},_renderEventsLink:function(){var r=this.props.session.get('events');if(!r||r.isEmpty())return l.createElement('span',null,'None');return (l.createElement('a',{href:'#',onClick:this._handleEventsLinkClick},'Click to View'));},_handleDialogToggle:function(r){this.setState({isDialogOpen:r});},_handleEventsLinkClick:function(r){r.preventDefault();this.setState({isDialogOpen:true});}});function q(r){return m(r/1000,'M d, Y g:ia');}f.exports=p;},null);
__d('OzAIDashboardContainer.react',['immutable','OzAPI','OzAIDashboard.react','React'],function a(b,c,d,e,f,g,h,i,j,k){'use strict';if(c.__markCompiled)c.__markCompiled();var l=h.List,m=h.Map,n=k.PropTypes,o=30,p={sessions:l(),isLoaded:false,offset:0},q=k.createClass({displayName:'OzAIDashboardContainer',propTypes:{witIntents:n.instanceOf(m).isRequired},getInitialState:function(){return babelHelpers._extends({},p,{isLoading:false,isReversed:true,sortBy:'won',uuid:undefined,selectedModule:undefined});},componentDidMount:function(){this._handleFetchRequest();},render:function(){return (k.createElement(j,{intentMetas:this.props.witIntents,sessions:this.state.sessions,modules:this.state.modules,selectedModule:this.state.selectedModule,isLoaded:this.state.isLoaded,isLoading:this.state.isLoading,isReversed:this.state.isReversed,onFetchRequest:this._handleFetchRequest,onIsReversedChange:this._handleIsReversedChange,onSortByChange:this._handleSortByChange,onUUIDChange:this._handleUUIDChange,onModuleChange:this._handleModuleChange,sortBy:this.state.sortBy,uuid:this.state.uuid}));},_handleFetchRequest:function(){if(this.state.isLoading||this.state.isLoaded)return;this.setState({isLoading:true});i.aiDashboard({offset:this.state.offset,limit:o,uuid:this.state.uuid,reverse:this.state.isReversed||undefined,'sort-by':this.state.sortBy||undefined,module:this.state.selectedModule}).done((function(r){this.setState({sessions:this.state.sessions.concat(r),isLoaded:r.size<o,isLoading:false,offset:this.state.offset+r.size});}).bind(this));},_handleModuleChange:function(r){this.setState(babelHelpers._extends({},p,{selectedModule:r}),this._handleFetchRequest);},_handleUUIDChange:function(r){this.setState(babelHelpers._extends({},p,{uuid:r}),this._handleFetchRequest);},_handleIsReversedChange:function(r){this.setState(babelHelpers._extends({},p,{isReversed:r}),this._handleFetchRequest);},_handleSortByChange:function(r){this.setState(babelHelpers._extends({},p,{sortBy:r}),this._handleFetchRequest);}});f.exports=q;},null);
__d('OzLastEvent.react',['cx','OzHelpers','OzConstants','ReactComponentWithPureRenderMixin','React'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();var m=j.AUTHOR_TYPES,n=l.PropTypes,o=l.createClass({displayName:'OzLastEvent',mixins:[k],propTypes:{name:n.string.isRequired,lastEvent:n.object.isRequired},render:function(){var p=this.props.lastEvent,q=i.authorType(p)===m.USER?this.props.name.split(' ')[0].substr(0,10):'M',r=p.get('text'),s=i.shortDesc(p)||'did something',t=r&&q+': '+r||q+' '+s;return (l.createElement('div',{className:"_4-_6 _4-_7",title:t},this._renderText(q,s)));},_renderText:function(p,q){return (l.createElement('span',null,l.createElement('span',{className:"_3ikz"},p,': '),q));}});f.exports=o;},null);
__d('OzMessage.react',['cx','getURLRanges','OzHelpers','immutable','Link.react','MNCommerceAgentItemSuggestionMercuryShareAttachment.react','ReactComponentWithPureRenderMixin','React','TextWithEntities.react','XStickerAssetController'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){if(c.__markCompiled)c.__markCompiled();var r=k.Map,s=k.List,t=o.PropTypes,u=o.createClass({displayName:'OzMessage',mixins:[n],propTypes:{message:t.instanceOf(r).isRequired},render:function(){var ra=this.props.message,sa=ra.get('attachments')||s(),ta=s([ra.get('text')&&pa(ra.get('text'))]).concat(sa.map(function(ua){var va=ca(ua)&&da(ua)||ja(ua)&&la(ka(ua))||ia(ua)&&la(ua.get('uri'))||ga(ua)&&ha(ua)||ea(ua)&&fa(ua)||z(ua)&&aa(ua)||v(ua)&&y(x(ua.get('metadata')))||w(ua)&&y(j.uiSuggestion(ua.get('suggestion')))||ma(ua)&&na(ua.getIn(['xma','link']))||ua.get('uri')&&na(ua.get('uri'));if(va){return va;}else{j.error('could not render attachment',ua.toJS(),ra.toJS());return qa('Oops. We could not render this attachment.');}})).filter(function(ua){return !!ua;}).map(function(ua,va){return o.createElement('frag',{key:va},ua);});if(ta.size){return o.createElement('span',null,ta);}else{j.error('no text or attachments',ra.toJS());return qa('Oops. We did not get text or attachments.');}}}),v=function(ra){return ra.hasIn(['metadata','target_url']);},w=function(ra){return ra.has('suggestion');},x=function(ra){if(!r.isMap(ra.get('total_cost'))&&ra.has('raw_amount'))ra=ra.set('total_cost',r({amount:+ra.get('raw_amount')}));return ra.toJS();};function y(ra){return (o.createElement('div',{className:"_53qw"},o.createElement(m,{attachment:{target:ra}})));}var z=function(ra){var sa=ra.get('metadata');return sa&&sa.get('location')&&sa.get('url')&&sa.get('image_url');};function aa(ra){return la(ra.getIn(['metadata','image_url']),ra.getIn(['metadata','url']));}var ba=function(ra){var sa=ra.get('uri'),ta=ra.get('sticker_id');if(ta)sa=q.getURIBuilder().setInt('sticker_id',ta).getURI();return sa;},ca=function(ra){return ra.get('sticker_id')&&ba(ra);};function da(ra){return o.createElement('img',{className:"__vl",src:ba(ra)});}var ea=function(ra){return (/video/.test(ra.get('mime_type'))&&ra.get('uri'));};function fa(ra){return (o.createElement('video',{controls:true,height:'300',width:'300'},o.createElement('source',{src:ra.get('uri'),type:ra.get('mime_type')})));}var ga=function(ra){return (/audio/.test(ra.get('mime_type'))&&ra.get('uri'));};function ha(ra){return (o.createElement('audio',{className:"_1d86",controls:true},o.createElement('source',{src:ra.get('uri'),type:ra.get('mime_type')})));}var ia=function(ra){var sa=/blob:/.test(ra.get('uri')),ta=/\.(jpg|gif|png)/.test(ra.get('uri'));return ra.get('uri')&&(j.isImageType(ra.get('mime_type'))||sa||ta);},ja=function(ra){return (/base64/.test(ra.get('mime_type'))&&ra.get('data'));},ka=function(ra){return ra.get('mime_type')+','+ra.get('data');};function la(ra,sa){return (o.createElement('a',{href:sa||ra,target:'_blank',className:"_4y6l",style:{backgroundImage:'url(\''+ra+'\')'}}));}var ma=function(ra){return !!ra.getIn(['xma','link']);};function na(ra){return (o.createElement('div',{className:"_4y6k"},o.createElement('a',{href:ra,target:'_blank'},'Attachment Link')));}function oa(ra,sa){return (o.createElement(l,{target:'_blank',href:sa.entity},ra));}function pa(ra){return (o.createElement(p,{className:"_4y6k",text:ra,interpolator:oa,ranges:i(ra),renderEmoticons:true,renderEmoji:true}));}function qa(ra){return (o.createElement('div',{className:"_4y6k _5kng"},ra));}f.exports=u;},null);
__d('OzFeedbackDashboard.react',['Promise','OzAPI','cx','OzHelpers','immutable','OzButton.react','OzConfig','OzMessage.react','OzSearchSource','ReactComponentWithPureRenderMixin','React','ReactRouter','SearchableDropdownInput.contrib','SearchableEntry','Stars.react'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){if(c.__markCompiled)c.__markCompiled();var w=l.Map,x=r.PropTypes,y=r.createClass({displayName:'OzFeedbackDashboard',mixins:[s.Navigation,q],propTypes:{reps:x.instanceOf(w).isRequired},contextTypes:{uid:x.string.isRequired},getInitialState:function(){return {messages:w(),authorID:this.context.uid};},componentWillMount:function(){this._searchSource=new p((function(oa){var pa=(oa.query||'').toLowerCase();return new h((function(qa){return qa(this.props.reps.valueSeq().map(ga).concat([ga('autoresponse-bot'),ga('survey-bot')]).sortBy(function(ra){return ra.getTitle();}).filter(function(ra){return (ra.getTitle()||'').toLowerCase().indexOf(pa)>-1;}).toJS());}).bind(this));}).bind(this));},componentDidMount:function(){this._fetchFeedback();},render:function(){return (r.createElement('div',{className:"_60f"},n.GK.supervisor?r.createElement(z,{reps:this.props.reps,authorID:this.state.authorID,searchSource:this._searchSource,onSelect:(function(oa){return this.setState({messages:w(),activeMessage:null,authorID:oa.getUniqueID()},this._fetchFeedback);}).bind(this)}):null,r.createElement(aa,{messages:this.state.messages}),r.createElement(da,{messages:this.state.messages,reps:this.props.reps,activeMessage:this.state.activeMessage||this.state.messages.first(),onMessageClick:(function(oa){return this.setState({activeMessage:oa});}).bind(this),onSeeThreadClick:(function(oa){return this.transitionTo('inbox/show',{threadid:oa});}).bind(this)})));},_fetchFeedback:function(){i.authorFeedback(this.state.authorID).done((function(oa){oa=oa.sortBy(function(pa){return -pa.get('timestamp');});this.isMounted()&&this.setState({messages:oa});}).bind(this));}}),z=k.pure(function(oa){var pa=oa.reps,qa=oa.authorID,ra=oa.searchSource,sa=oa.onSelect;return (r.createElement('div',{className:"_5p66"},r.createElement('div',{className:"_wa_"},r.createElement(t,{value:ga(pa.get(qa)||qa),onSelect:sa,placeholder:'Pick a rep',emptySearchResultsText:'No Rep found',searchSource:ra}))));}),aa=k.pure(function(oa){var pa=oa.messages,qa=na(pa,-7,0),ra=na(pa,-14,-7);return (r.createElement('div',{className:"_wb0"},r.createElement('div',{className:"_wb1"},r.createElement(ba,{label:'OVERALL RATING'},ma(qa),'%'),r.createElement(ba,{label:'SINCE LAST WEEK'},r.createElement(ca,{value:ma(qa)-ma(ra)}))),r.createElement('div',{className:"_wb2"},r.createElement(ba,{label:'TONE'},ka(qa),'%'),r.createElement(ba,{label:'RESPONSIVENESS'},ja(qa),'%'),r.createElement(ba,{label:'EXECUTION'},ia(qa),'%'),r.createElement(ba,{label:'POLICY'},la(qa),'%')),r.createElement('div',{className:"_3gch"},r.createElement(ba,{label:'FEEDBACK GIVEN LAST WEEK'},qa.size))));}),ba=k.pure(function(oa){var pa=oa.label,qa=oa.children;return (r.createElement('div',{className:"_wb3"},r.createElement('span',{className:"_wb4"},qa),r.createElement('span',{className:"_wb5"},pa)));}),ca=k.pure(function(oa){var pa=oa.value;return (r.createElement('div',{className:(pa>0?"_wb6":'')+(pa<0?' '+"_wb7":'')},pa>0?'+':null,pa,'%'));}),da=k.pure(function(oa){var pa=oa.messages,qa=oa.reps,ra=oa.activeMessage,sa=oa.onMessageClick,ta=oa.onSeeThreadClick,ua=ra&&ra.get('reviews'),va=ra&&ra.get('user-id');return (r.createElement('div',{className:"_wb8"},r.createElement('div',{className:"_wbc"},r.createElement('div',{className:"_4fj7"},pa.map(function(wa){return (r.createElement('div',{key:k.msgID(wa),onClick:function(xa){return sa(wa);},className:"_wbf"+(wa===ra?' '+"_wbg":'')},r.createElement(o,{message:wa})));}).valueSeq())),r.createElement('div',{className:"_wbh"},r.createElement('div',{className:"_wbe"},ua?ua.map(function(wa){return (r.createElement(ea,{key:wa.get('id'),rep:qa.get(wa.get('reviewer-id')),review:wa}));}).valueSeq():null)),r.createElement('div',{className:"_wbi"},va?r.createElement(m,{onClick:function(wa){return ta(va);}},'See Thread'):null)));}),ea=k.pure(function(oa){var pa=oa.review,qa=oa.rep;return (r.createElement('div',{className:"_wbj"},r.createElement('div',{className:"_wbk"},r.createElement('h2',{className:"_wbl"},qa&&qa.get('name')),pa.has('tone')?r.createElement(fa,{label:'Tone'},r.createElement(v,{count:pa.get('tone'),max:3,size:'large'})):null,pa.has('responsiveness')?r.createElement(fa,{label:'Responsiveness'},r.createElement(v,{count:pa.get('responsiveness'),max:3,size:'large'})):null,pa.has('execution')?r.createElement(fa,{label:'Execution'},r.createElement(v,{count:pa.get('execution'),max:3,size:'large'})):null,pa.has('followed-policy')?r.createElement(fa,{label:'Followed Policy?'},r.createElement('div',{className:"_wbm"},pa.get('followed-policy')?'YES':'NO')):null),r.createElement('div',{className:"_wbn"},pa.get('body'))));}),fa=k.pure(function(oa){var pa=oa.label,qa=oa.children;return (r.createElement('div',{className:"_wbo"},qa,r.createElement('div',{className:"_wbp"},pa)));});function ga(oa){var pa=function(qa){return new u(qa);};return oa?oa.get?pa({title:oa.get('name'),uniqueID:oa.get('fbid')}):pa({title:oa,uniqueID:oa}):null;}function ha(oa,pa){return function(qa){var ra=qa.valueSeq().flatMap(function(va){return va.get('reviews');}).filter(function(va){return va&&va.has(oa);}),sa=ra.reduce(function(va,wa){var xa=va[0],ya=va[1];return [xa+pa,ya+wa.get(oa)];},[0,0]),ta=sa[0],ua=sa[1];return ta?Math.round(ua/ta*100):0;};}var ia=ha('execution',3),ja=ha('responsiveness',3),ka=ha('tone',3),la=ha('followed-policy',1);function ma(oa){return Math.round((ja(oa)+ka(oa)+la(oa))/3);}function na(oa,pa,qa){var ra=new Date().getDate(),sa=+new Date(Date.now()).setDate(ra+pa),ta=+new Date(Date.now()).setDate(ra+qa);return oa.filter(function(ua){var va=+ua.get('timestamp');return va>=sa&&va<=ta;});}f.exports=y;},null);
__d('OzInbox.react',['OzAPI','cx','OzHelpers','DataTransfer','immutable','OzActions','OzInboxThreadList.react','OzInboxThreads','OzStores','OzTabHeader.react','ReactComponentWithPureRenderMixin','React','Reflux','ReactRouter','promiseFinally'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){if(c.__markCompiled)c.__markCompiled();var w=l.Map,x=l.OrderedMap,y=l.List,z=p.HumanStore,aa=p.ThreadStore,ba=s.PropTypes,ca=u.RouteHandler,da=o.OZ_GRABBED_TAB,ea=o.OZ_VIEWING_TAB,fa=o.OZ_PAST_TAB,ga=5000,ha=30000,ia=da,ja=s.createClass({displayName:'OzInbox',mixins:[t.connect(aa,'threads'),t.connect(z,'humans'),u.State,u.Navigation],propTypes:{requirements:ba.instanceOf(w).isRequired,witIntents:ba.instanceOf(w).isRequired,merchants:ba.instanceOf(w).isRequired,reps:ba.instanceOf(w).isRequired},contextTypes:{uid:ba.string.isRequired},getInitialState:function(){return {activeTab:null,loading:false};},componentDidMount:function(){this._fetchThreads();var pa=window.setInterval((function(ra){return this._fetchThreads();}).bind(this),ha),qa=window.setInterval((function(){var ra=this.threads(this._getActiveTab());if(ra.some(function(sa){return sa.get('ui-reassign');}))m.clearReassignState();}).bind(this),ga);this._cleanup=(function(){ia=this._getActiveTab();window.clearInterval(qa);window.clearInterval(pa);}).bind(this);},componentDidUpdate:function(pa,qa){var ra=this.getParams().threadid;if(ra){var sa=!!this.state.threads.get(ra);j.debug('[ozinbox] tid='+ra+' hasThread='+sa);sa||la(ra);}else{var ta=this.threads(),ua=p.ActiveThreadStore.data.get('oldThreadID'),va=ta.get(ua)||ta.first();j.debug('[ozinbox] search for best thread, found:',va);if(va)this.transitionTo('inbox/show',{threadid:j.threadID(va)});}},componentWillUnmount:function(){this._cleanup();},render:function(){var pa=this._getActiveTab(),qa=this.threads(pa),ra=this.state.humans.getIn([this.context.uid,'load'],0),sa=function(ta){return ta.preventDefault();};return (s.createElement('div',{className:"_4b5_",onDragStart:sa,onDragEnd:sa,onDragOver:sa,onDrop:function(ta){sa(ta);var ua=new k(ta.nativeEvent.dataTransfer);m.updateComposer({files:ua.getFiles()});}},s.createElement(ka,{threadGroups:na(qa,this.context.uid,pa),reps:this.props.reps,loading:this.state.loading,activeCount:ra,activeTab:pa,selectedThread:this.getParams().threadid,onTabChange:this._handleTabChange,onUnview:this._handleUnview,onThreadClick:this._handleThreadClick,witIntents:this.props.witIntents}),this._renderDetails()));},_getActiveTab:function(){var pa=this.state.threads.get(this.getParams().threadid);return this.state.activeTab||pa&&j.isOwner(pa,this.context.uid)&&da||pa&&j.isSubscriber(pa,this.context.uid)&&ea||ia||da;},_handleUnview:function(pa){this._callAPIAndShift('unview',pa);},_handleThreadClick:function(pa){this.transitionTo('inbox/show',{threadid:j.threadID(pa)});},_handleTabChange:function(pa){var qa=pa[0],ra=pa[1];this.setState({activeTab:ra});},_callAPIAndShift:function(pa,qa){var ra=ma(this.threads(da),qa),sa=(function(ua){this.transitionTo('inbox/show',{threadid:j.threadID(ua)});}).bind(this),ta=h[pa](j.threadID(qa));ra&&sa(ra);ta.done(null,function(ua){j.error('[inbox] could not shift',ua);sa(qa);});},_renderDetails:function(){var pa=this.getParams(),qa=pa.threadid;if(this.threads().isEmpty())return this._renderFinished();var ra=this.state.threads.get(qa);if(!ra)return null;return (s.createElement(ca,{thread:ra,witIntents:this.props.witIntents,requirements:this.props.requirements,merchants:this.props.merchants,humans:this.state.humans,reps:this.props.reps}));},_renderFinished:function(){return (s.createElement('div',{className:"_57l3"},s.createElement('div',{className:"_57l8"},s.createElement('div',{className:"_57lo"}),s.createElement('h2',null,'Congrats! You\'ve made a lot of people happy'),s.createElement('p',null,'Sit tight, new messages should be coming soon!'))));},_fetchThreads:function(){var pa=this.state.loading;if(pa)return;this.setState({loading:true});v(h.myThreads(),(function(qa){return this.isMounted()&&this.setState({loading:false});}).bind(this)).done();},threads:function(pa){return o.getInboxThreads(this.state.threads,this.context.uid,pa);}}),ka=s.createClass({displayName:'OzThreadListPanel',mixins:[r],propTypes:babelHelpers._extends({activeTab:ba.oneOf([da,ea,fa]).isRequired,onTabChange:ba.func.isRequired},n.propTypes),render:function(){var pa=this.props,qa=pa.activeTab,ra=pa.onTabChange,sa=pa.activeCount,ta=babelHelpers.objectWithoutProperties(pa,['activeTab','onTabChange','activeCount']),ua=sa?'Open ('+sa+')':'Open';return (s.createElement('div',{className:"_4b61"},s.createElement(q,{active:qa,tabs:[[ua,da],['Viewing',ea],['Closed',fa]],onChange:ra}),s.createElement('div',{className:"_3_cz"},s.createElement('div',{className:"_4fj7"},s.createElement(n,babelHelpers._extends({className:qa===da?"_2sav":''},ta))))));}}),la=j.memoize(h.thread,function(pa){return pa;});function ma(pa,qa){var ra=j.threadID(qa),sa=pa.toList(),ta=sa.findIndex(function(wa){return j.threadID(wa)===ra;}),ua=ta-1,va=ta+1;if(va<sa.count()){return sa.get(va);}else if(ua>=0)return sa.get(ua);}function na(pa,qa,ra){var sa;switch(ra){case da:return oa(pa,qa,ra);default:return x((sa={},sa[ra]=pa,sa));}}function oa(pa,qa,ra){var sa='Needs Attention',ta='Up For Grabs',ua='Waiting',va=function(wa){var xa=j.isOwner(wa,qa),ya=wa.get('ready'),za=j.isLocker(wa,qa),ab=j.hasOpenIntents(wa);return xa&&(za||ya&&ab)?sa:ya?ta:ua;};return x().withMutations(function(wa){wa.set(sa,[]);wa.set(ta,[]);wa.set(ua,[]);pa.forEach(function(xa){return wa.update(va(xa),function(ya){ya.push(xa);return ya;});});}).map(function(wa){return y(wa);});}f.exports=ja;},null);
__d('OzMerchantDialog.react',['cx','OzHelpers','immutable','Layout.react','MessengerDialog.react','MessengerDialogHeader.react','MessengerDialogTitle.react','OzActions','React','ReactDOM','XUIDatePicker.react','XUIError.react'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){if(c.__markCompiled)c.__markCompiled();var t=k.Column,u=k.FillColumn,v=p.PropTypes,w=j.Map,x=j.Set,y=x(['name-dba','name-legal','website','phone','address','page-id','country','type','owner-name']),z=w({country:'US'}),aa=p.createClass({displayName:'OzMerchantDialog',propTypes:{onMerchant:v.func.isRequired,title:v.string,initialMerchant:v.instanceOf(w)},getDefaultProps:function(){return {title:"Create a merchant",initialMerchant:w()};},getInitialState:function(){var ba=this.props.initialMerchant,ca=z.filterNot(function(da,ea){return ba.get(ea);});return {inputs:ca,errors:w()};},componentDidMount:function(){var ba=q.findDOMNode(this.refs['name-dba']);ba&&ba.focus();},render:function(){return (p.createElement(l,{className:"_18w8",onToggle:this._handleToggle,ref:'dialog',type:'default',width:544},p.createElement(m,null,p.createElement(n,null,this.props.title)),this._renderFields(),p.createElement('div',null,this._renderDialogAction('Save',this._handleSave),this._renderDialogAction('Cancel',o.hideDialog))));},_renderDialogAction:function(ba,ca){return p.createElement('button',{onClick:ca,className:"_bx0 _3e2t _30yy"},ba);},_renderFields:function(){return (p.createElement('div',{className:"_374d _18w9"},this._renderTextField('name-dba','Name *'),this._renderTextField('name-legal','Legal Name'),this._renderTextField('website','Website'),this._renderTextField('phone','Phone'),this._renderTextField('address','Address'),this._renderTextField('page-id','Facebook Page Id'),this._renderTextField('country','Country *'),this._renderTextField('type','Business Type'),this._renderTextField('owner-name','Owner Name'),this._renderDateField('owner-birth-date','Owner Birth Date')));},_renderTextField:function(ba,ca){var da=this.props.initialMerchant,ea=this.state,fa=ea.inputs,ga=ea.errors;return (p.createElement(k,{key:ba},p.createElement(t,{className:"mrm _bx1"},ca),p.createElement(u,null,p.createElement(s,{xuiError:ga.get(ba)||null},p.createElement('input',{ref:ba,type:'text',className:"_7q5 _bx2",defaultValue:da.get(ba),value:fa.get(ba),onChange:(function(ha){this.setState({inputs:fa.set(ba,ha.target.value),errors:w()});}).bind(this)})))));},_renderDateField:function(ba,ca){var da={},ea=this.props.initialMerchant,fa=ea.get('owner-birth-date');if(fa)da.initialTime=fa;return (p.createElement(k,{key:ba},p.createElement(t,{className:"mrm _bx1"},ca),p.createElement(t,null,p.createElement(r,babelHelpers._extends({ref:ba,shouldSetDefaultDate:false},da)))));},_handleSave:function(){var ba=this._validateData();if(ba){ba.id=this.props.initialMerchant.get('id');this.props.onMerchant(ba);}},_handleToggle:function(ba){if(!ba)o.hideDialog();},_validateData:function(){var ba=w(),ca=this.props.initialMerchant,da=(function(ga){var ha=this.state.inputs.get(ga,undefined);if(ha===undefined)return ca.get(ga);return ha||null;}).bind(this);ba=w(y.map(function(ga){return [ga,da(ga)];})).set('id',ca.get('id'));var ea=this.refs['owner-birth-date'].state.selectTime;ba=ba.set('owner-birth-date',ea);ba=i.normalizeMerchant(ba);var fa=i.validateMerchant(ba);this.setState({errors:fa});if(!fa.isEmpty())return null;return ba;}});f.exports=aa;},null);
__d('OzIntentFactoryHelpers',['immutable','React','OzIntentParamsStringField.react','OzIntentParamsNumberField.react','OzIntentParamsPriceRangeField.react','OzIntentParamsDateTimeField.react'],function a(b,c,d,e,f,g,h,i){'use strict';if(c.__markCompiled)c.__markCompiled();var j=h.Map,k={makeStateUpdater:function(n){return function(o){var p;this._setStateAndSave((p={},p[n]=o,p));};},makeStateExtractor:function(n){return function(o){var p=o.get('params')||j(),q={};for(var r=n,s=Array.isArray(r),t=0,r=s?r:r[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var u;if(s){if(t>=r.length)break;u=r[t++];}else{t=r.next();if(t.done)break;u=t.value;}var v=u,w=v.name,x=v.type,y=l(p,w);switch(x){case 'string':q[w]=y||'';break;case 'number':case 'pricerange':q[w]=+y||null;break;case 'datetime':q[w]=y&&new Date(y);}}return babelHelpers._extends({},q,{notes:o.get('notes')||''});};},makeParamsUpdater:function(n){return function(o,p){return (o||j()).withMutations(function(q){for(var r=n,s=Array.isArray(r),t=0,r=s?r:r[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var u;if(s){if(t>=r.length)break;u=r[t++];}else{t=r.next();if(t.done)break;u=t.value;}var v=u,w=v.name,x=v.type;switch(x){case 'datetime':var y=p[w],z=y?{value:y.toISOString(),grain:'minute'}:undefined;m(q,w,z);break;default:m(q,w,{value:p[w]});break;}}});};},makeFieldRenderer:function(n){return function(){return n.map((function(o){var p=o.label,q=o.name,r=o.placeholder,s=o.type,t=k.getFieldComponent(s);return (i.createElement(t,{key:q,label:p,onChange:this._changeHandlers.get(q),placeholder:r||p,value:this.state[q]}));}).bind(this));};},getFieldComponent:function(n){switch(n){case 'string':return c('OzIntentParamsStringField.react');case 'number':return c('OzIntentParamsNumberField.react');case 'pricerange':return c('OzIntentParamsPriceRangeField.react');case 'datetime':return c('OzIntentParamsDateTimeField.react');default:throw new Error('OzIntentFactoryHelpers: Unknown field type '+n+'.');}}};function l(n,o){var p=n.get(o);if(p&&!p.isEmpty())return p.first().get('value');return null;}function m(n,o,p){n.set(o,h.fromJS([p]));}f.exports=k;},null);
__d('OzIntentFactory',['immutable','Map','OzAPI','OzGenericIntent.react','OzIntentFactoryHelpers','OzIntentSchemas','ReactComponentWithPureRenderMixin','React','debounce'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){'use strict';if(c.__markCompiled)c.__markCompiled();var q=o.PropTypes,r=new i(),s={get:function(u){var v=m.get(u);if(!r.has(u))r.set(u,t(v));return r.get(u);}};function t(u){var v=h.Map,w=u.name,x=u.fields,y=10000,z=l.makeStateExtractor(x),aa=l.makeFieldRenderer(x),ba=l.makeParamsUpdater(x);return o.createClass({displayName:'Oz'+w+'DynamicIntent',mixins:[n],propTypes:{intent:q.instanceOf(v).isRequired,intentMeta:q.instanceOf(v).isRequired,onCallClick:q.func.isRequired,onClose:q.func.isRequired,onOpen:q.func.isRequired,requirements:q.instanceOf(v).isRequired,onCreateRequirement:q.func,onDelete:q.func,onDeleteRequirement:q.func},getInitialState:function(){return babelHelpers._extends({isEditing:false},z(this.props.intent));},componentWillMount:function(){this._saveIntent=p(this._saveIntent,500,this,true);this._changeHandlers=v().withMutations((function(ca){for(var da=x,ea=Array.isArray(da),fa=0,da=ea?da:da[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var ga;if(ea){if(fa>=da.length)break;ga=da[fa++];}else{fa=da.next();if(fa.done)break;ga=fa.value;}var ha=ga;ca.set(ha.name,l.makeStateUpdater(ha.name).bind(this));}}).bind(this));},componentWillReceiveProps:function(ca){var da=this.state.isEditing;if(h.is(ca.intent,this.props.intent)||da)return;this.setState(z(ca.intent));},componentWillUnmount:function(){window.clearTimeout(this._editingTimeout);},render:function(){return (o.createElement(k,babelHelpers._extends({},this.props,{notes:this.state.notes,onNotesChange:this._handleNotesChange}),this._renderFields()));},_renderFields:aa,_handleNotesChange:function(ca){this._setStateAndSave({notes:ca});},_saveIntent:function(){var ca=this.props.intent;j.editIntent(ca.get('user-id'),v({id:ca.get('id'),params:ba(ca.get('params'),this.state),notes:this.state.notes}));},_setStateAndSave:function(ca){window.clearTimeout(this._editingTimeout);this.setState(babelHelpers._extends({isEditing:true},ca),this._saveIntent);this._editingTimeout=window.setTimeout((function(da){return this.setState({isEditing:false});}).bind(this),y);}});}f.exports=s;},null);
__d('OzIntentList.react',['OzHelpers','OzAPI','immutable','OzIntent.react','ReactComponentWithPureRenderMixin','React','ReactCSSTransitionGroup','OzActions'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){if(c.__markCompiled)c.__markCompiled();var p=m.PropTypes,q=j.Map,r=m.createClass({displayName:'OzIntentList',mixins:[l],propTypes:{threadID:p.string.isRequired,intents:p.instanceOf(j.List).isRequired,requirements:p.instanceOf(j.Map).isRequired,witIntents:p.instanceOf(j.Map).isRequired},render:function(){var s=this.props.witIntents,t=this.props.intents.map(function(u){var v=u.get('wit-intent-uuid'),w=s.get(v);if(!w){h.error('could not find witIntent for',u);return [u,q({name:u.get('name')+' ('+v+')'})];}return [u,w];}).filter(function(u){return !!u;}).map(this._renderIntent).valueSeq();if(t.isEmpty())return null;return (m.createElement('div',null,m.createElement(n,{transitionName:'oz-fade-in-out',transitionEnterTimeout:300,transitionLeaveTimeout:300},t)));},_renderIntent:function(s){var t=s[0],u=s[1];return (m.createElement(k,{intent:t,intentMeta:u,key:t.get('id'),onCallClick:o.twilio.showDialog,onClose:this._handleClose,onCreateRequirement:this._handleCreateRequirement,onDelete:this._handleDelete,onDeleteRequirement:this._handleDeleteRequirement,onOpen:this._handleOpen,requirements:this.props.requirements}));},_handleClose:function(s){i.closeIntent(this.props.threadID,s);},_handleDelete:function(s){i.deleteIntent(this.props.threadID,s);},_handleOpen:function(s){i.openIntent(this.props.threadID,s);},_handleDeleteRequirement:function(s,t){i.deleteIntentRequirement(this.props.threadID,s,t);},_handleCreateRequirement:function(s,t){i.createIntentRequirement(this.props.threadID,s,t);}});f.exports=r;},null);
__d('OzIntentPicker.react',['Promise','immutable','OzSearchSource','React','SearchableDropdownInput.contrib','SearchableEntry','XUIError.react','cx'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){if(c.__markCompiled)c.__markCompiled();var p=i.Map,q=k.PropTypes,r=k.createClass({displayName:'OzIntentPicker',contextTypes:{witIntents:q.instanceOf(p).isRequired},propTypes:{onPick:q.func.isRequired,diag:q.instanceOf(p),onToggle:q.func},getInitialState:function(){return {selected:null,errors:p()};},componentWillMount:function(){this._searchSource=new j((function(w){var x=w.query;return h.resolve(s(x,this.context.witIntents));}).bind(this));},componentDidMount:function(){var w=this.refs&&this.refs.dropdown,x=!!document.querySelector('*:focus');if(w&&!x)w.focusInput();},render:function(){return (k.createElement('div',{className:"_4nd2"},k.createElement(n,{xuiError:this.state.errors.get('picker')},k.createElement(l,{ref:'dropdown',searchSource:this._searchSource,value:this._selected(),onSelect:(function(w){return this.setState({selected:w});}).bind(this),placeholder:'Pick Intent'})),k.createElement('button',{className:"_4nd3 _4nd4 _30yy",onClick:this._handlePick})));},_selected:function(){var w=this.props.diag;return this.state.selected||u(w,this.context.witIntents);},_handlePick:function(){var w=p(),x=this._selected();if(!x)w=w.set('picker','You need to select an intent');this.setState({errors:w});if(w.size)return;this.props.onPick(p({name:x.getTitle(),'wit-intent-uuid':x.getUniqueID()}));}});function s(w,x){if(!w)return [];return x.filter(function(y){return (!v(y)&&(y.get('name')+y.get('doc')).toLowerCase().indexOf(w)>=0);}).map(t).valueSeq().take(15).toJS();}function t(w){return new m({title:w.get('name'),subtitle:w.get('doc'),uniqueID:w.get('id')});}function u(w,x){if(!w)return null;var y=x.get(w.get('wit-intent-uuid'));if(!y||v(y))return null;return t(y.merge(w));}function v(w){return w.get('name').match(/^dialog_/);}f.exports=r;},null);
__d('OzMessageFeedback.react',['cx','OzHelpers','joinClasses','ContextualLayerAutoFlip','ContextualLayerUpdateOnScroll','immutable','ReactLayeredComponentMixin','MessengerButton.react','OzMessageCommentDialog.react','OzMessageFeedbackDialog.react','ReactComponentWithPureRenderMixin','React','XUIContextualDialog.react'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){if(c.__markCompiled)c.__markCompiled();var u=m.Map,v=s.PropTypes,w='comment_dialog',x='feedback_dialog',y='no_dialog',z=s.createClass({displayName:'OzMessageFeedback',mixins:[n,r],propTypes:{message:v.instanceOf(u).isRequired,onSave:v.func.isRequired},getInitialState:function(){return babelHelpers._extends({currentDialog:y},ba(this.props.message));},componentWillReceiveProps:function(da){if(da.message!==this.props.message)this.setState(ba(da.message));},render:function(){var da=this.props,ea=da.message,fa=da.onSave,ga=this.state,ha=ga.currentDialog,ia=ga.feedback,ja=ca(this.state);return (s.createElement('div',{className:"_2bxa"+(' '+"_2bxb")+(ja?' '+"_2bxc":'')+(ha!==y?' '+"_2bxd":'')},s.createElement(aa,{className:"_2bxe",onClick:(function(ka){return this.setState({currentDialog:w});}).bind(this),isActive:!!ia||ha===w,ref:'comment'}),s.createElement(aa,{className:"_2bxf",onClick:(function(ka){return this.setState({currentDialog:x});}).bind(this),isActive:ja||ha===x,ref:'flag'})));},renderLayers:function(){switch(this.state.currentDialog){case w:return {contextualDialog:this._renderCommentDialog()};case x:return {contextualDialog:this._renderFeedbackDialog()};default:return null;}},_renderFeedbackDialog:function(){return (s.createElement(q,{contextRef:(function(){return this.refs.flag;}).bind(this),executionRating:this.state.executionRating,followedPolicy:this.state.followedPolicy,onClose:this._handleDialogClose,onExecutionRatingChange:(function(da){this.setState({executionRating:da});}).bind(this),onFollowedPolicyChange:(function(da){this.setState({followedPolicy:da});}).bind(this),onResponsivenessRatingChange:(function(da){this.setState({responsivenessRating:da});}).bind(this),onSave:this._handleFeedbackSave,onToneRatingChange:(function(da){this.setState({toneRating:da});}).bind(this),responsivenessRating:this.state.responsivenessRating,toneRating:this.state.toneRating}));},_renderCommentDialog:function(){return (s.createElement(p,{contextRef:(function(){return this.refs.comment;}).bind(this),feedback:this.state.feedback,onBlur:this._handleDialogClose,onFeedbackChange:(function(da){this.setState({feedback:da});}).bind(this),onSave:this._handleCommentSave}));},_handleFeedbackSave:function(){this.props.onSave(u({execution:this.state.executionRating,'followed-policy':this.state.followedPolicy,mid:this.props.message.get('mid'),responsiveness:this.state.responsivenessRating,tone:this.state.toneRating}));this._handleDialogClose();},_handleCommentSave:function(){this.props.onSave(u({feedback:this.state.feedback,mid:this.props.message.get('mid')}));this._handleDialogClose();},_handleDialogClose:function(){this.setState({currentDialog:y});}}),aa=s.createClass({displayName:'FeedbackButton',render:function(){var da=this.props,ea=da.className,fa=da.onClick,ga=da.isActive;return (s.createElement('button',{role:'button',className:j("_1-hv"+(' '+"_2bxi")+(ga?' '+"_2bxj":''),ea),onClick:fa}));}});function ba(da){return {executionRating:da.get('execution'),feedback:da.get('feedback'),followedPolicy:da.get('followed-policy'),responsivenessRating:da.get('responsiveness'),toneRating:da.get('tone')};}function ca(da){return !!(da.executionRating||da.followedPolicy!==undefined||da.responsivenessRating||da.toneRating);}f.exports=z;},null);
__d('OzInboxMessage.react',['OzAPI','cx','OzHelpers','immutable','OzConfig','OzConstants','OzIntentPicker.react','OzMessage.react','OzMessageFeedback.react','ReactComponentWithPureRenderMixin','React'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){if(c.__markCompiled)c.__markCompiled();var s=k.Map,t=m.AUTHOR_TYPES,u=r.PropTypes,v=r.createClass({displayName:'OzInboxMessage',mixins:[q],propTypes:{authorType:u.oneOf(j.values(t)),message:u.instanceOf(s).isRequired},contextTypes:{witIntents:u.instanceOf(s).isRequired},render:function(){var w=this.props,x=w.message,y=w.authorType,z=w.thread,aa=!!x.get('author');return (r.createElement('div',{className:"clearfix"+(' '+"_4y6j")+(y===t.TRAINER?' '+"_2ij4":'')+(y===t.BOT?' '+"_2ij5":'')+(y===t.USER?' '+"_2p0":'')+(l.GK.supervisor?' '+"_1w52":'')},r.createElement('div',{className:"_2pf"},r.createElement(o,{message:x})),aa?r.createElement(p,{message:x,onSave:function(ba){return h.updateMessage(j.threadID(z),ba);}}):null,this._renderIntentPicker()));},_renderIntentPicker:function(){var w=this.props,x=w.message,y=w.thread;if(x.get('ui-last-user-msg'))return (r.createElement('div',{className:"_2x3x"},r.createElement(n,{diag:y.get('intent-diag'),onPick:this._handlePick})));return null;},_handlePick:function(w){h.createIntent(j.threadID(this.props.thread),w).done();}});f.exports=v;},null);
__d('OzTodoIntentList.react',['OzHelpers','immutable','OzIntentList.react','ReactComponentWithPureRenderMixin','React'],function a(b,c,d,e,f,g,h,i,j,k,l){'use strict';if(c.__markCompiled)c.__markCompiled();var m=i.Map,n=l.PropTypes,o=l.createClass({displayName:'OzTodoIntentList',mixins:[k],propTypes:{requirements:n.instanceOf(m).isRequired,thread:n.instanceOf(m).isRequired,witIntents:n.instanceOf(m).isRequired},render:function(){var p=h.openIntents(this.props.thread);return (l.createElement(j,{intents:p,requirements:this.props.requirements,threadID:h.threadID(this.props.thread),witIntents:this.props.witIntents}));}});f.exports=o;},null);
__d('OzIntentDashboardUUIDFilter.react',['immutable','ReactComponentWithPureRenderMixin','React','XUISingleSelector.react'],function a(b,c,d,e,f,g,h,i,j,k){'use strict';if(c.__markCompiled)c.__markCompiled();var l=h.Map,m=j.PropTypes,n=k.Option,o=j.createClass({displayName:'OzIntentDashboardUUIDFilter',mixins:[i],propTypes:{intentMetas:m.instanceOf(l).isRequired,onUUIDChange:m.func.isRequired,uuid:m.string},render:function(){return (j.createElement(k,{maxheight:400,onChange:this._handleUUIDChange,value:this.props.uuid||'__none__'},j.createElement(n,{value:'__none__'},'Select an intent category'),p(this.props.intentMetas).valueSeq().map(function(r){return (j.createElement(n,{key:r.get('id'),value:r.get('id')},r.get('name')));})));},_handleUUIDChange:function(r){this.props.onUUIDChange(q(r.value));}});function p(r){return r.sortBy(function(s){return s.get('name');});}function q(r){return r!=='__none__'?r:undefined;}f.exports=o;},null);
__d('OzIntentDashboardFilters.react',['immutable','InputLabel.react','OzIntentDashboardUUIDFilter.react','OzTriSwitch.react','ReactComponentWithPureRenderMixin','React','XUISingleSelector.react','cx'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){'use strict';if(c.__markCompiled)c.__markCompiled();var p=h.Map,q=m.PropTypes,r=n.Option,s=k.fromBoolean,t=k.toBoolean,u=m.createClass({displayName:'OzIntentDashboardFilters',mixins:[l],propTypes:{intentMetas:q.instanceOf(p).isRequired,isEmployee:q.bool,isReversed:q.bool.isRequired,onIsEmployeeChange:q.func.isRequired,onIsReversedChange:q.func.isRequired,onSortByChange:q.func.isRequired,onUUIDChange:q.func.isRequired,sortBy:q.string,sortableFields:q.instanceOf(p).isRequired,uuid:q.string},render:function(){return (m.createElement('ul',{className:"_1bo-"},m.createElement('li',null,this._renderUUIDFilter()),m.createElement('li',null,this._renderSortByFilter()),m.createElement('li',null,this._renderIsReversedFilter()),m.createElement('li',null,this._renderIsEmployeeFilter())));},_renderUUIDFilter:function(){return (m.createElement(j,{intentMetas:this.props.intentMetas,onUUIDChange:this.props.onUUIDChange,uuid:this.props.uuid}));},_renderIsEmployeeFilter:function(){return (m.createElement(k,{animated:true,label:'Employee?',onClick:(function(w){this.props.onIsEmployeeChange(t(w));}).bind(this),value:s(this.props.isEmployee)}));},_renderIsReversedFilter:function(){return (m.createElement(i,null,m.createElement('input',{checked:this.props.isReversed,onChange:(function(w){this.props.onIsReversedChange(w.target.checked);}).bind(this),type:'checkbox'}),m.createElement('label',null,'Reversed?')));},_renderSortByFilter:function(){return (m.createElement(n,{maxheight:400,onChange:this._handleSortByChange,value:this.props.sortBy||'__none__'},m.createElement(r,{value:'__none__'},'Select a field to sort by'),this.props.sortableFields.map(function(w,x){return (m.createElement(r,{key:x,value:x},w));}).valueSeq()));},_handleSortByChange:function(w){this.props.onSortByChange(v(w.value));}});function v(w){return w!=='__none__'?w:undefined;}f.exports=u;},null);
__d('ozFormatTime',[],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=3600,i=60;function j(k){var l=Math.floor(k/h);k%=h;var m=Math.floor(k/i);k%=i;var n=Math.round(k),o='';if(l)o+=l+'h ';if(m)o+=m+'m ';if(n)o+=n+'s';return o;}f.exports=j;},null);
__d('OzIntentDashboardEventsDialog.react',['DialogFitHeight','immutable','InputLabel.react','ReactComponentWithPureRenderMixin','React','XUIDialog.react','XUIDialogBody.react','XUIDialogFooter.react','XUIDialogOkayButton.react','XUIDialogTitle.react','XUITable.react','cx','formatDate','ozFormatTime'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){'use strict';if(c.__markCompiled)c.__markCompiled();var v=i.Map,w=l.PropTypes,x=l.createClass({displayName:'OzIntentDashboardEventsDialog',mixins:[k],propTypes:{intent:w.instanceOf(v).isRequired,onToggle:w.func.isRequired,shown:w.bool.isRequired},getInitialState:function(){return {isFiltered:true};},render:function(){return (l.createElement(m,{behaviors:{DialogFitHeight:h},onToggle:this.props.onToggle,shown:this.props.shown,width:900},l.createElement(q,null,l.createElement('span',null,'Events for Intent ',this.props.intent.get('id'))),l.createElement(n,null,l.createElement(j,null,l.createElement('input',{checked:this.state.isFiltered,onChange:(function(ba){this.setState({isFiltered:ba.target.checked});}).bind(this),type:'checkbox'}),l.createElement('label',null,'Filter Non-Message Events?')),this._renderTable()),l.createElement(o,null,l.createElement(p,{use:'confirm',action:'cancel'}))));},_renderTable:function(){return (l.createElement(r,{className:"_4m7c",outerBorder:true},l.createElement('thead',null,l.createElement('tr',null,l.createElement('th',null,'Agent ID'),l.createElement('th',null,'Type'),l.createElement('th',null,'Time'),l.createElement('th',null,'Since Start'),l.createElement('th',null,'Text/Data'),l.createElement('th',null,'Attachment'))),l.createElement('tbody',null,this._getEvents().map(this._renderRow))));},_renderRow:function(event,ba,ca){var da=event.get('type'),ea=event.get('from-m?'),fa=ca.first().get('time'),ga=event.get('time');return (l.createElement('tr',{key:ba},l.createElement('td',null,event.get('agent-id')),l.createElement('td',null,da),l.createElement('td',{className:"_4m7d"},z(ga)),l.createElement('td',null,u((ga-fa)/1000)),l.createElement('td',{className:"_4m7e"+(da==='send'&&ea?' '+"_4m7j":'')},y(event)),l.createElement('td',null,aa(event.get('attachment')))));},_getEvents:function(){var ba=this.props.intent.get('events').toSeq();if(this.state.isFiltered)ba=ba.filter(function(event){var ca=event.get('type');return ca==='send'||ca==='message';});return ba;}});function y(event){var ba=event.get('text'),ca=event.get('data');return ba?ba:ca&&JSON.stringify(ca.toJS());}function z(ba){return t(ba/1000,'M d, Y g:ia');}function aa(ba){if(ba==null)return ba;var ca=JSON.parse(ba);return (l.createElement('a',{href:ca.uri,target:'_blank'},'Source'));}f.exports=x;},null);
__d('OzIntentDashboardRow.react',['immutable','ReactLayeredComponentMixin','OzIntentDashboardEventsDialog.react','ReactComponentWithPureRenderMixin','React','formatDate','ozFormatTime'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n){'use strict';if(c.__markCompiled)c.__markCompiled();var o=h.Map,p=l.PropTypes,q=l.createClass({displayName:'OzIntentDashboardRow',mixins:[i,k],propTypes:{intent:p.instanceOf(o).isRequired,intentMeta:p.instanceOf(o)},getInitialState:function(){return {isDialogOpen:false};},render:function(){var t=this.props,u=t.intent,v=t.intentMeta,w=u.get('user-vcard')||o();return (l.createElement('tr',null,l.createElement('td',null,u.get('id')),l.createElement('td',null,w.get('name')),l.createElement('td',null,s(w)),l.createElement('td',null,v&&v.get('name')),l.createElement('td',null,u.get('state')),l.createElement('td',null,r(u.get('created-at'))),l.createElement('td',null,n(u.get('total-time'))),l.createElement('td',null,this._renderEventsLink())));},renderLayers:function(){if(!this.state.isDialogOpen)return {};return {dialog:l.createElement(j,{intent:this.props.intent,onToggle:this._handleDialogToggle,shown:this.state.isDialogOpen})};},_renderEventsLink:function(){var t=this.props.intent.get('events');if(!t||t.isEmpty())return l.createElement('span',null,'None');return (l.createElement('a',{href:'#',onClick:this._handleEventsLinkClick},'Click to View'));},_handleDialogToggle:function(t){this.setState({isDialogOpen:t});},_handleEventsLinkClick:function(t){t.preventDefault();this.setState({isDialogOpen:true});}});function r(t){return m(t/1000,'M d, Y g:ia');}function s(t){var u=t.get('is-employee');return u==null?'UNKNOWN':u?'YES':'NO';}f.exports=q;},null);
__d('OzIntentDashboard.react',['immutable','MessengerFlexScrollableArea.react','OzIntentDashboardFilters.react','OzIntentDashboardRow.react','ReactComponentWithPureRenderMixin','React','XUITable.react'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n){'use strict';if(c.__markCompiled)c.__markCompiled();var o=h.List,p=h.Map,q=m.PropTypes,r=p({id:'ID',state:'Status','created-at':'Created At','total-time':'Time Spent'}),s=m.createClass({displayName:'OzIntentDashboard',mixins:[l],propTypes:{intentMetas:q.instanceOf(p).isRequired,intents:q.instanceOf(o).isRequired,isEmployee:q.bool,isLoaded:q.bool.isRequired,isLoading:q.bool.isRequired,isReversed:q.bool.isRequired,onFetchRequest:q.func.isRequired,onIsEmployeeChange:q.func.isRequired,onIsReversedChange:q.func.isRequired,onSortByChange:q.func.isRequired,onUUIDChange:q.func.isRequired,sortBy:q.string,uuid:q.string},render:function(){return (m.createElement(i,{onScroll:this._handleScroll,ref:'scrollable'},m.createElement(j,{intentMetas:this.props.intentMetas,isEmployee:this.props.isEmployee,isReversed:this.props.isReversed,onIsEmployeeChange:this.props.onIsEmployeeChange,onIsReversedChange:this.props.onIsReversedChange,onSortByChange:this.props.onSortByChange,onUUIDChange:this.props.onUUIDChange,sortBy:this.props.sortBy,sortableFields:r,uuid:this.props.uuid}),this._renderTable(),this._renderLoadMoreLink()));},_renderTable:function(){var t=this.props.intentMetas;return (m.createElement(n,{outerBorder:false},m.createElement('thead',null,m.createElement('tr',null,m.createElement('th',null,'ID'),m.createElement('th',null,'User Name'),m.createElement('th',null,'Employee?'),m.createElement('th',null,'Intent'),m.createElement('th',null,'Status'),m.createElement('th',null,'Created At'),m.createElement('th',null,'Time Spent'),m.createElement('th',null,'Events'))),m.createElement('tbody',null,this.props.intents.map(function(u){return (m.createElement(k,{intent:u,intentMeta:t.get(u.get('wit-intent-uuid')),key:u.get('id')}));}))));},_renderLoadMoreLink:function(){if(this.props.isLoaded)return null;if(this.props.isLoading)return m.createElement('div',null,'Loading...');return (m.createElement('div',null,m.createElement('a',{href:'#',onClick:(function(t){t.preventDefault();this.props.onFetchRequest();}).bind(this)},'Fetch More Intents')));},_handleScroll:function(){if(!this.props.isLoading&&!this.props.isLoaded&&this.refs.scrollable&&this.refs.scrollable.isScrolledToBottom())this.props.onFetchRequest();}});f.exports=s;},null);
__d('OzIntentDashboardContainer.react',['immutable','OzAPI','OzIntentDashboard.react','React'],function a(b,c,d,e,f,g,h,i,j,k){'use strict';if(c.__markCompiled)c.__markCompiled();var l=h.List,m=h.Map,n=k.PropTypes,o=30,p={intents:l(),isLoaded:false,offset:0},q=k.createClass({displayName:'OzIntentDashboardContainer',propTypes:{witIntents:n.instanceOf(m).isRequired},getInitialState:function(){return babelHelpers._extends({},p,{isEmployee:undefined,isLoading:false,isReversed:false,sortBy:undefined,uuid:undefined});},componentDidMount:function(){this._handleFetchRequest();},render:function(){return (k.createElement(j,{intentMetas:this.props.witIntents,intents:this.state.intents,isEmployee:this.state.isEmployee,isLoaded:this.state.isLoaded,isLoading:this.state.isLoading,isReversed:this.state.isReversed,onFetchRequest:this._handleFetchRequest,onIsEmployeeChange:this._handleIsEmployeeChange,onIsReversedChange:this._handleIsReversedChange,onSortByChange:this._handleSortByChange,onUUIDChange:this._handleUUIDChange,sortBy:this.state.sortBy,uuid:this.state.uuid}));},_handleFetchRequest:function(){if(this.state.isLoading||this.state.isLoaded)return;this.setState({isLoading:true});i.intentsDashboard({offset:this.state.offset,limit:o,uuid:this.state.uuid,reverse:this.state.isReversed||undefined,'sort-by':this.state.sortBy||undefined,'is-employee':this.state.isEmployee}).done((function(r){this.setState({intents:this.state.intents.concat(r),isLoaded:r.size<o,isLoading:false,offset:this.state.offset+r.size});}).bind(this));},_handleUUIDChange:function(r){this._setFilter({uuid:r});},_handleIsEmployeeChange:function(r){this._setFilter({isEmployee:r});},_handleIsReversedChange:function(r){this._setFilter({isReversed:r});},_handleSortByChange:function(r){this._setFilter({sortBy:r});},_setFilter:function(r){this.setState(babelHelpers._extends({},p,r),this._handleFetchRequest);}});f.exports=q;},null);
__d('OzMerchantRow.react',['OzAPI','OzHelpers','immutable','Layout.react','LeftRight.react','MessengerDialogHeader.react','MessengerDialogTitle.react','Notice.atlas','OzActions','OzButton.react','OzMerchantDialog.react','OzMerchantStatus.react','ReactComponentWithPureRenderMixin','React','XUIDialog.react','cx'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){if(c.__markCompiled)c.__markCompiled();var x=j.Map,y=k.Column,z=k.FillColumn,aa=u.PropTypes,ba=u.createClass({displayName:'DeleteMerchantDialog',propTypes:{merchant:aa.object.isRequired,onConfirm:aa.func.isRequired},render:function(){return (u.createElement(v,{width:544,shown:true,layerHideOnBlur:false,className:"_4ebx"},u.createElement('div',{className:"_4eby _2c9g"},u.createElement(m,null,u.createElement(n,null,'Delete merchant "'+this.props.merchant.get('name-dba')+'\"?')),u.createElement(o,{type:'error'},u.createElement('div',{className:"_4wby"},'This action is irreversible. Are you sure?'),u.createElement(l,null,u.createElement(q,{onClick:p.hideDialog},'Cancel'),u.createElement(q,{onClick:this.props.onConfirm},'Yes, permanently delete this merchant'))))));},_handleToggle:function(da){i.debug('[merchantdialog] toggle',arguments);if(!da)p.hideDialog();}}),ca=u.createClass({displayName:'OzMerchantRow',mixins:[t],propTypes:{merchant:aa.instanceOf(x).isRequired},render:function(){var da=this.props.merchant,ea=da.get('website'),fa=function(ha){return '$'+(ha?(ha/100).toFixed(2):0);},ga=function(ha){return ha||0;};return (u.createElement(k,{className:"_59hd"},u.createElement(y,{className:"mrm _728"},u.createElement(s,{merchant:da})),this._renderMerchantInfo('name-dba'),this._renderMerchantInfo('name-legal'),this._renderMerchantInfo('phone'),this._renderMerchantInfo('cumulative-transaction-amount',fa),this._renderMerchantInfo('cumulative-transaction-count',ga),u.createElement(z,{className:"mrm _4wc2 _4wc3"},u.createElement('a',{target:'_blank',href:ea},ea)),this._renderActions()));},_renderMerchantInfo:function(da,ea){var fa=this.props.merchant,ga=fa.get(da);if(ea)ga=ea(ga);return (u.createElement(y,{className:"mrm _4wc2 _72a"},ga));},_renderActions:function(){var da=this._getActions();if(!da)return null;var ea=da.map(function(fa){var ga=fa.f,ha=fa.body;return u.createElement(q,{key:ha,onClick:ga},ha);});return (u.createElement(y,{className:"mrm _6w4"},ea));},_getActions:function(){var da=[],ea=this.props.merchant;da.push({body:'Edit',f:this._handleMerchantEdit()});da.push({body:'Delete',f:this._handleMerchantDelete()});if(ea.get('blacklisted')===true){da.push({body:'Whitelist',f:this._handleMerchantBlacklist(false)});}else da.push({body:'Blacklist',f:this._handleMerchantBlacklist(true)});return da;},_handleMerchantEdit:function(){return (function(da,ea){var fa=this.props.merchant;p.showDialog(r,{initialMerchant:fa,title:'Edit merchant '+fa.get('name-dba'),onMerchant:function(ga){h.editMerchant(ga);p.hideDialog();}});ea();}).bind(this);},_handleMerchantBlacklist:function(da){return (function(ea,fa){var ga=this.props.merchant;h.editMerchant(x({id:ga.get('id'),blacklisted:da}));fa();}).bind(this);},_handleMerchantDelete:function(){return (function(da,ea){var fa=this.props.merchant;p.showDialog(ba,{merchant:this.props.merchant,onConfirm:function(){h.deleteMerchant(x({id:fa.get('id')})).then(p.hideDialog);}});ea();}).bind(this);}});f.exports=ca;},null);
__d('OzMerchants.react',['OzAPI','immutable','Layout.react','MessengerFlexScrollableArea.react','OzActions','OzButton.react','OzMerchantDialog.react','OzMerchantRow.react','React','cx'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){if(c.__markCompiled)c.__markCompiled();var r=j.Column,s=j.FillColumn,t=i.Map,u=p.PropTypes,v=p.createClass({displayName:'OzMerchants',propTypes:{merchants:u.instanceOf(t).isRequired},getInitialState:function(){return {slice:25};},render:function(){if(this.props.merchants.isEmpty())return this._renderEmpty();return (p.createElement(j,null,p.createElement(s,null,this._renderToolbar(),this._renderMerchants())));},_createMerchant:function(){l.showDialog(n,{onMerchant:function(w){h.createMerchant(w);l.hideDialog();}});},_renderToolbar:function(){return (p.createElement(j,{className:"_726"},p.createElement(r,{className:"mrm _727 _728"},'Status'),this._renderToolbarCell('Name'),this._renderToolbarCell('Legal Name'),this._renderToolbarCell('Phone'),this._renderToolbarCell('Transaction total'),this._renderToolbarCell('Transaction count'),p.createElement(s,{className:"mrm _727"},'Website'),p.createElement(r,{className:"mrm _729"},p.createElement(m,{onClick:this._createMerchant},'New merchant'))));},_renderToolbarCell:function(w){return (p.createElement(r,{className:"mrm _727 _72a"},w));},_renderMerchants:function(){var w=this.props.merchants.sortBy(function(x){return x.get('name-dba','').toLowerCase();}).toSeq().take(this.state.slice).map(function(x){return (p.createElement(o,{key:x.get('name-dba'),merchant:x}));}).valueSeq();return (p.createElement(k,{className:"_72b",onScroll:this._handleScroll,ref:'scrollable'},w));},_renderEmpty:function(){return p.createElement('div',null,'No merchants to show');},_handleScroll:function(){if(this.refs.scrollable.isScrolledToBottom())this.setState(function(w){return {slice:w.slice+25};});}});f.exports=v;},null);
__d('OzMount',['OzAPI','OzHelpers','invariant','Oz.react','OzAIDashboardContainer.react','OzAll.react','OzConfig','OzFeedbackDashboard.react','OzInbox.react','OzInboxShow.react','OzIntentDashboardContainer.react','OzLoading.react','OzMerchants.react','OzStatsDashboardContainer.react','OzTop.react','OzTrainerDashboard.react','React','ReactDOM','ReloadPage','ReactRouter','URI','OzTwilio'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca){if(c.__markCompiled)c.__markCompiled();ca;var da=aa.Route,ea=aa.HistoryLocation,fa=aa.Redirect,ga={mount:function(la,ma){ma=babelHelpers._extends({},ma,ka());i.setConfig(ma);i.info('[config]',ma);h.witIntents();h.merchants();h.humans();h.requirements();n.GK.voip&&h.init();var na=x.createElement(da,{handler:k},x.createElement(da,{name:'inbox',handler:p},x.createElement(da,{name:'inbox/show',path:':threadid',handler:q})),x.createElement(da,{name:'all',path:'all',handler:m}),x.createElement(da,{name:'merchants',path:'merchants',handler:t}),x.createElement(da,{name:'top',path:'top',handler:v}),x.createElement(da,{name:'intents',path:'intents',handler:r}),x.createElement(da,{name:'ai',path:'ai',handler:l}),x.createElement(da,{name:'feedback',path:'feedback',handler:o}),x.createElement(da,{name:'trainers',path:'trainers',handler:w}),x.createElement(da,{name:'stats',path:'stats',handler:u}),x.createElement(fa,{from:'',to:'/inbox'})),oa,pa=function(){h.repsSync();aa.run(na,ea,function(ta){y.render(x.createElement(ta,{rev:ma.rev,uid:ma.uid,version:ma.API_VERSION,skipToto:ma.skipToto==='true',onUnmount:function(){oa&&oa();}}),la);});},qa='Hello '+ma.publicName+'! Oz is connecting...';y.render(x.createElement(s,{message:qa}),la);var ra=i.getConfig('skipSky')==='true';if(ra)pa();i.info('[sky] connecting to '+ma.skyTopic);var sa=function(ta){if(ta<0){alert('Something is very wrong! Could not connect to Skywalker');z.now();return;}if(typeof oa==='function')oa();oa=h.realTime(ma.skyTopic,function(ua,va,wa){if(ua){i.warn('[sky] could not connect: '+ua);return sa(ta-1);}else i.info('[sky] connected to '+ma.skyTopic+': '+va.t,va);if(!ra)pa();});};sa(3);}},ha=/^ozcfg(.+)/;function ia(){var la=new ba(window.location.href).getQueryData();Object.keys(la).forEach(function(ma){if(ha.test(ma))localStorage.setItem(ma,la[ma]);});}function ja(){var la,ma,na,oa={};for(la=0;la<localStorage.length;la++){ma=localStorage.key(la);na=ma.match(ha);if(na&&na.length)oa[na[1]]=localStorage.getItem(ma);}return oa;}function ka(){ia();var la=ja(),ma,na=document.location.hostname;if(na==='www.oz.wit.ai'){ma={skyTopic:'oz/all',env:'prod',scubaCategory:'oz_console',PAGE_ID:'881263441913087',API_PATH:'https://www.oz.wit.ai/api'};}else if(na==='intern.oz.wit.ai'||!la.API_PATH){ma={skyTopic:'oz-staging/all',env:'staging',scubaCategory:'oz_console_dev',PAGE_ID:'506060876211905',API_PATH:'https://intern.oz.wit.ai/api'};}else{var oa=na.split('.')[1];ma={skyTopic:'oz-dev/'+oa,env:'dev',scubaCategory:'oz_console_dev',PAGE_ID:'1579802578966277'};}ma=babelHelpers._extends({},ma,la,{API_VERSION:'20151027'});!ma.API_PATH?j(0):undefined;return ma;}f.exports=ga;},null);
__d('OzPresence.react',['joinClasses','timeString','React','cx'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l=j.PropTypes;function m(o){if(!o)return "_3dn7";var p=Math.floor((Date.now()-new Date(o))/1000);if(p<60*20){return "_3dn8";}else return "_3dn9";}var n=j.createClass({displayName:'OzPresence',propTypes:{lastPresence:l.number},componentDidMount:function(){var o=setInterval(this.forceUpdate.bind(this),60000);this._cleanup=function(){clearInterval(o);};},componentWillUnmount:function(){this._cleanup();},render:function(){var o=this.props.lastPresence,p=m(o);return (j.createElement('span',{className:h(p,"_3dna")},j.createElement('i',{className:"_3dnb"}),j.createElement('span',{className:"_3dnc"},o?'Active '+i(o):'Never active')));}});f.exports=n;},null);