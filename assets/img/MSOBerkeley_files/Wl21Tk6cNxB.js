/*!CK:3779925368!*//*1450221846,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["zCtyF"]); }

__d('MercuryJewelThreadlistControl',['ArbiterMixin','CurrentUser','CSS','DOM','Event','JSLogger','MercuryConfig','MercuryFilters','MercuryThreadlistConstants','MercuryThreadlistContainer.react','MessagesJewelThreadList.react','MessagingTag','WebMessengerPermalinkConstants','React','ReactDOM','csx','cx','fbt','MercuryThreadInformer','MercuryUnreadState'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y){if(c.__markCompiled)c.__markCompiled();var z=c('MercuryThreadInformer').get(),aa=c('MercuryUnreadState').get(),ba=m.create('mercury_jewel'),ca=n.CoreGraphEnabled?s.PENDING:s.OTHER,da=n.CoreGraphEnabled?t.PENDING_PATH:t.OTHER_PATH,ea='back_to_inbox';function fa(ja){var ka=ja.getFlyout();this._jewelController=ja;this._threadlistContainer=k.find(ka,"._3v_l");this._currentFolder=s.INBOX;this._currentFilter=o.ALL;this._jewelTabLinks={};this._jewelTabCounts={};this._jewelTabLinks[s.INBOX]=k.find(ka,"._1sde");this._jewelTabCounts[s.INBOX]=k.find(ka,"._1sdg");l.listen(this._jewelTabLinks[s.INBOX],'click',ga.bind(this,s.INBOX,o.ALL));if(!n.JewelRequestsUI){this._jewelTabLinks[ca]=k.find(ka,"._1sdf");this._jewelTabCounts[ca]=k.find(ka,"._1sdh");l.listen(this._jewelTabLinks[ca],'click',ga.bind(this,ca,o.ALL));}else{this._jewelTabLinks[ea]=k.find(ka,"._34zq");l.listen(this._jewelTabLinks[ea],'click',ga.bind(this,s.INBOX,o.ALL));}this._markAllReadLink=k.find(ka,"._1c1m");this._seeAllLink=k.find(ka,'.seeMore');l.listen(this._markAllReadLink,'click',(function(la){aa.markFolderAsRead(this._currentFolder);la.kill();}).bind(this));z.subscribe('unread-updated',ha.bind(this));ha.bind(this)();this.render();ba.bump('opened_threadlist_'+this._currentFolder);}Object.assign(fa.prototype,h);Object.assign(fa.prototype,{render:function(){v.render(u.createElement(q,{ChildClass:r,viewer:i.getID(),folder:this._currentFolder,filter:this._currentFilter,jewelRequestsUI:n.JewelRequestsUI,onMessageRequestsClick:this._handleMessageRequestsClick.bind(this),onFilteredRequestsClick:this._handleFilteredRequestsClick.bind(this)}),this._threadlistContainer);},_handleMessageRequestsClick:function(ja){ja.preventDefault();ga.call(this,s.PENDING,o.ALL);},_handleFilteredRequestsClick:function(ja){ja.preventDefault();ga.call(this,s.OTHER,o.ALL);}});function ga(ja,ka){if(this._currentFolder!==ja||this._currentFilter!==ka){var la=this._currentFolder,ma=ja===s.INBOX,na=ja;ba.bump('opened_threadlist_'+ja);if(this._jewelTabLinks[na])j.addClass(this._jewelTabLinks[na],"_1sdd");if(this._jewelTabLinks[la])j.removeClass(this._jewelTabLinks[la],"_1sdd");this._currentFolder=ja;this._currentFilter=ka;if(ma){this._seeAllLink.href=t.BASE_PATH;}else this._seeAllLink.href=da;if(n.JewelRequestsUI){j.conditionShow(this._jewelTabLinks[s.INBOX],ma);j.conditionShow(this._jewelTabLinks[ea],!ma);}this.render();}}function ha(){ia.call(this,s.INBOX);if(!n.JewelRequestsUI)ia.call(this,ca);}function ia(ja){var ka;if(aa.exceedsMaxCount(ja)){ka=p.MAX_UNREAD_COUNT;}else ka=aa.getUnreadCount(ja);var la=this._jewelTabCounts[ja];if(!la)return;if(ka>0){if(ka==p.MAX_UNREAD_COUNT)ka+='+';k.setContent(la,y._("({unread_count})",[y.param('unread_count',ka)]));}else k.setContent(la,'');}f.exports=fa;},null);